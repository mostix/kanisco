<?php  function print_html_login_header($page_title,$page_description) {    global $languages;  global $current_lang;?><!DOCTYPE HTML><html><head>    <meta charset="utf-8">    <title><?=$page_title; ?></title>    <meta name="description" content="<?=$page_description; ?>" />    <meta name="keywords" content="" />    <meta name="viewport" content="width=device-width">    <meta name="robots" content="noindex, nofollow" />    <meta name="author" content="Iliyan Dimitrov">    <link href="/site/images/index.ico" rel="shortcut icon" />    <link href="/_admin/css/mainstyle.css" rel="stylesheet" type="text/css"  media="screen" /></head><body><?php}  function print_html_admin_header($page_title,$page_description = "", $additional_script = false) {    global $db_link;  global $languages;  global $current_lang;    if(!isset($_SESSION['admin']['user_id']) || (isset($_SESSION['admin']['user_id']) && empty($_SESSION['admin']['user_id']))) {    echo '<script>window.location.href="/_admin"</script>';  }    $body_nav_class = "opened_nav";  if(isset($_COOKIE['nav'])) $body_nav_class = $_COOKIE['nav'];  //echo "<pre>";print_r($_SESSION);?><!DOCTYPE HTML><html><head>    <meta charset="utf-8">    <title><?=$page_title;?></title>    <meta name="description" content="<?=$page_description;?>" />    <meta name="keywords" content="" />    <meta name="viewport" content="width=device-width">    <meta name="robots" content="noindex, nofollow" />    <meta name="author" content="Iliyan Dimitrov">    <link href="/site/images/index.ico" rel="shortcut icon" />    <link href="/_admin/css/mainstyle.css" rel="stylesheet" type="text/css"  media="screen" />    <link href="/js/jquery-ui-1.11.4/jquery-ui.min.css" rel="stylesheet" type="text/css" />    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>    <script src="/js/jquery-ui-1.11.4/jquery-ui.min.js" type="text/javascript"></script>    <script src="/_admin/js/dropzone.min.js" type="text/javascript"></script>    <script src="/_admin/js/functions.js" type="text/javascript"></script>    <?php if($additional_script) echo "$additional_script\n";?>    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"></head><body class="<?=$body_nav_class;?>">  <div id="modal_window_backgr"></div>  <div id="modal_window"></div>  <div id="ajax_loader">    <img src="/site/images/ajax-loader.gif" alt="ajax-loader" width="32" height="32">    <span><?=$languages[$current_lang]['loading'];?>...</span>  </div>  <div id="ajax_notification">    <span class="close_warning">Close</span>    <p class="ajaxmessage"></p>  </div>  <!--header-->  <header>    <div class="inside_container">      <aside>        <?=$languages[$current_lang]['welcome'];?> <?=$_SESSION['admin']['user_fullname'];?> | <a href="<?=$_SERVER['PHP_SELF'];?>?logout=yes" class="logout"><?=$languages[$current_lang]['logout'];?></a>      </aside>      <h1 id="logo">        <a href="/_admin" title="<?=$languages[$current_lang]['title_logo_homepage'];?>">          <?=$languages[$current_lang]['e_shop_cms'];?>        </a>      </h1>      <div class="clearfix"></div>    </div>  </header><!--header--><!--navigation-->  <nav>    <ul id="menu">      <li class="menu_li_1_level"><span title="<?=$languages[$current_lang]['title_open_close'];?>" class="open_close_nav">&nbsp;</span></li><?php    $menu_parent_id = 0;    $user_id = $_SESSION['admin']['user_id'];    print_html_admin_menu($menu_parent_id, $user_id);//      $cyr_url = str_replace(array('а', 'б', 'в', 'г', 'д', 'е', 'ё', 'ж', 'з', 'и', 'й', 'к', 'л', 'м', 'н', 'о', 'п', 'р', 'с', 'т', 'у', 'ф', 'х', 'ц', 'ч', 'ш', 'щ', 'ь', 'ъ', 'ы', 'э', 'ю', 'я'), array('a', 'b', 'v', 'g', 'd', 'e', 'jo', 'zh', 'z', 'i', 'i', 'k', 'l', 'm', 'n', 'o', 'p', 'r', 's', 't', 'u', 'f', 'h', 'ts', 'ch', 'sh', 'sch', 'j', 'j', 'y', 'e', 'y', 'ya'), $menu_friendly_url);?>      <li class="menu_li_1_level">&nbsp;</li>    </ul>    <div class="clearfix"></div>  </nav><!--navigation--><?php    }function list_user_menu_rights($menu_id, $user_id) {    global $db_link;  global $languages;  global $current_lang;    $query_menus = "SELECT `menus`.*, `users_rights`.`users_rights_id`, `users_rights`.`user_id`, `users_rights`.`menu_id` as `user_access_to_menu`,                         `users_rights`.`users_rights_edit`, `users_rights`.`users_rights_delete`                  FROM `menus`                  LEFT JOIN (`users_rights`) ON (`users_rights`.`user_id` = '$user_id' AND `users_rights`.`menu_id` = `menus`.`menu_id`)                  WHERE `menus`.`menu_parent_id` = '$menu_id' AND `menu_is_active` = 1                   ORDER BY `menu_sort_order` ASC";  //echo $query_menus."<br>";  $result_menus = mysqli_query($db_link, $query_menus);  if(!$result_menus) echo mysqli_error($db_link);  if (mysqli_num_rows($result_menus) > 0) {    while ($menus = mysqli_fetch_assoc($result_menus)) {            $details_btn = "";      $menu_id = $menus['menu_id'];      $menu_name = $menus['menu_name'];      //$menu_name = $languages[$current_lang][$menu_name];      $menu_hierarchy_level = $menus['menu_hierarchy_level'];      $menu_has_children = $menus['menu_has_children'];      $user_access_to_menu = $menus['user_access_to_menu'];      $users_rights_edit = $menus['users_rights_edit'];      $users_rights_delete = $menus['users_rights_delete'];      if($menu_hierarchy_level == 0 && $menu_has_children == 1) {        $_SESSION['admin']['first_menu_level_id'] = $menu_id;        $details_btn = '<button class="menu_header button blue" button-id="'.$_SESSION['admin']['first_menu_level_id'].'">+</button>';      }      $class_menu_hierarchy_level = ($menu_hierarchy_level != 0 && isset($_SESSION['admin']['first_menu_level_id'])) ? " children children".$_SESSION['admin']['first_menu_level_id'] : "";      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>      <tr class="page<?php echo "$menu_id $class$class_menu_hierarchy_level";?>">        <td>&nbsp;</td>        <td style="text-align: left;"><?php      if ($menu_hierarchy_level == 0) echo "<b>$menu_name</b>";      if ($menu_hierarchy_level == 1) echo "&nbsp; - $menu_name";      if ($menu_hierarchy_level == 2) echo "&nbsp;&nbsp; - - $menu_name";      if ($menu_hierarchy_level == 3) echo "&nbsp;&nbsp;&nbsp; - - - $menu_name";?>        </td>        <td>            <div class="checkbox<?php echo (!empty($user_access_to_menu) ? " checkbox_checked" : NULL);?>">              <input type="checkbox" name="access" onclick="Checkbox(this);" <?php echo (!empty($user_access_to_menu) ? " checked = 'checked'" : NULL);?> value="<?=$menu_id;?>" />            </div>          </td>          <td>            <div class="checkbox<?php echo (!empty($users_rights_edit) ? " checkbox_checked" : NULL);?>">              <input type="checkbox" name="rights" onclick="Checkbox(this);" <?php echo (!empty($users_rights_edit) ? " checked = 'checked'" : NULL);?> value="edit" />            </div>          </td>          <td>            <div class="checkbox<?php echo (!empty($users_rights_delete) ? " checkbox_checked" : NULL);?>">              <input type="checkbox" name="rights" onclick="Checkbox(this);" <?php echo (!empty($users_rights_delete) ? " checked = 'checked'" : NULL);?> value="delete" />            </div>          </td>        <td><?=$details_btn;?></td>        <td>&nbsp;</td>      </tr><?php      list_user_menu_rights($menu_id, $user_id);    }    mysqli_free_result($result_menus);  }}function list_users_types($current_language_id) {    global $db_link;  global $languages;  global $current_lang;    $query_users_types = "SELECT `user_type_id`, `user_type_name`,`user_type_sort_order`                       FROM `users_types`                      WHERE `language_id` = '$current_language_id'                      ORDER BY `user_type_sort_order` ASC";  //echo $query_users_types;exit;  $result_users_types = mysqli_query($db_link, $query_users_types);  if(!$result_users_types) echo mysqli_error($db_link);  $users_types_count = mysqli_num_rows($result_users_types);  if($users_types_count > 0) {    $key = 0;    $class = ($key == 0) ? "even" : "$class";        while ($status_row = mysqli_fetch_assoc($result_users_types)) {      $user_type_id = $status_row['user_type_id'];      $user_type_name = stripslashes($status_row['user_type_name']);      $user_type_sort_order = $status_row['user_type_sort_order'];      $edit_link = "/_admin/administration/administration-users-type-details.php?user_type_id=$user_type_id";      $class = (($class == "odd") ? "even" : "odd");?>      <table class="row_over">        <tbody>          <tr id="tr_<?=$user_type_id;?>" class="<?=$class?>">            <td width="60%" class="text_left">              <a href="<?=$edit_link;?>" class="red_link"><?=$user_type_name;?></a>            </td>            <td width="20%">              <?php                // if($users_types_count > 1) we gonna give the appropriate moving options                // else we gonna leave this empty                if($users_types_count > 1) {                  if($key == 0) {              ?>                  <a href="javascript:;" onclick="MoveUserTypeForwardBackward('<?=$user_type_id;?>','<?=$user_type_sort_order;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                  </a>                <?php } elseif($key == $users_types_count-1) { ?>                  <a href="javascript:;" onclick="MoveUserTypeForwardBackward('<?=$user_type_id;?>','<?=$user_type_sort_order;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                  </a>                <?php } else { ?>                  <a href="javascript:;" onclick="MoveUserTypeForwardBackward('<?=$user_type_id;?>','<?=$user_type_sort_order;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                  </a>                  <a href="javascript:;" onclick="MoveOrderStatusForwardBackward('<?=$user_type_id;?>','<?=$user_type_sort_order;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                  </a>              <?php                   }                } // if($users_types_count > 1)              ?>            </td>            <td width="10%">              <a href="<?=$edit_link;?>">                <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />              </a>            </td>            <td width="10%">              <a href="javascript:;" class="delete_user_type" data-id="<?=$user_type_id;?>">                <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />              </a>            </td>          </tr>        </tbody>      </table><?php      $key++;    }    mysqli_free_result($result_users_types);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_user_type_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteUserType();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_user_type").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_user_type").click(function() {    $(".delete_user_type").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_users_type_default_rights($menu_parent_id, $user_type_id) {    global $db_link;  global $languages;  global $current_lang;      $query_users_rights = "SELECT `menus`.`menu_id`,`menu_hierarchy_level`,`menu_has_children`,`menu_name`,`menu_url`,`menu_sort_order`,`menu_is_active`,                                 `users_types_rights`.`menu_id` as `user_access_to_menu`,`users_rights_edit`, `users_rights_delete`                        FROM `menus`                        LEFT JOIN (`users_types_rights`) ON (`users_types_rights`.`user_type_id` = '$user_type_id' AND `users_types_rights`.`menu_id` = `menus`.`menu_id`)                         WHERE `menu_parent_id` = '$menu_parent_id' AND `menu_is_active` = '1' ORDER BY `menu_sort_order`";  $result_users_rights = mysqli_query($db_link, $query_users_rights);  if(!$result_users_rights) echo mysqli_error($db_link);  if (mysqli_num_rows($result_users_rights) > 0) {    $i = -1;    while ($users_rights_row = mysqli_fetch_assoc($result_users_rights)) {      $details_btn = "";      $menu_id = $users_rights_row['menu_id'];      $menu_name = $users_rights_row['menu_name'];      //$menu_name = $languages[$current_lang][$menu_name];      $menu_hierarchy_level = $users_rights_row['menu_hierarchy_level'];      $menu_has_children = $users_rights_row['menu_has_children'];      $user_access_to_menu = $users_rights_row['user_access_to_menu'];      $users_rights_edit = $users_rights_row['users_rights_edit'];      $users_rights_delete = $users_rights_row['users_rights_delete'];      if($menu_hierarchy_level == 0 && $menu_has_children == 1) {        $_SESSION['admin']['first_menu_level_id'] = $menu_id;        $details_btn = '<button class="menu_header button blue" button-id="'.$_SESSION['admin']['first_menu_level_id'].'">+</button>';      }      $class_menu_hierarchy_level = ($menu_hierarchy_level == 0) ? "" : " children children".$_SESSION['admin']['first_menu_level_id'];      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>      <tr class="single_page page<?="$menu_id $class$class_menu_hierarchy_level";?>" data-id="<?=$menu_id;?>">        <td>&nbsp;</td>        <td style="text-align: left;"><?php        if ($menu_hierarchy_level == 0) echo "<b>$menu_name</b>";        if ($menu_hierarchy_level == 1) echo "&nbsp; - $menu_name";        if ($menu_hierarchy_level == 2) echo "&nbsp;&nbsp; - - $menu_name";        if ($menu_hierarchy_level == 3) echo "&nbsp;&nbsp;&nbsp; - - - $menu_name";?>        </td>        <td>          <div class="menu_access checkbox<?=(!empty($user_access_to_menu) ? " checkbox_checked" : NULL);?>">            <input type="checkbox" name="rights_access" class="rights_access" onclick="Checkbox(this)" <?= (!empty($user_access_to_menu) ? " checked = 'checked'" : NULL);?> /><?php if(!empty($user_access_to_menu)) { ?>            <input type="hidden" name="menu_is_set" class="menu_is_set" value="<?= (!empty($user_access_to_menu) ? 1 : 0);?>"><?php } ?>          </div>        </td>        <td>          <div class="checkbox<?=(!empty($users_rights_edit) ? " checkbox_checked" : NULL);?>">            <input type="checkbox" name="rights_edit" class="rights_edit" onclick="Checkbox(this)" <?= (!empty($users_rights_edit) ? " checked = 'checked'" : NULL);?> />          </div>        </td>        <td>          <div class="checkbox<?=(!empty($users_rights_delete) ? " checkbox_checked" : NULL);?>">            <input type="checkbox" name="rights_delete" class="rights_delete" onclick="Checkbox(this)" <?= (!empty($users_rights_delete) ? " checked = 'checked'" : NULL);?> />          </div>        </td>        <td><?=$details_btn;?></td>        <td>&nbsp;</td>      </tr><?php      list_users_type_default_rights($menu_id, $user_type_id);    }    mysqli_free_result($result_users_rights);  }}function print_html_admin_menu($menu_parent_id, $user_id) {    global $db_link;  global $languages;  global $current_lang;  $query_menus = "SELECT `menus`.*, `users_rights`.*                  FROM `menus`                  INNER JOIN `users_rights` ON `users_rights`.`menu_id` = `menus`.`menu_id`                  WHERE `menus`.`menu_parent_id` = '$menu_parent_id' AND `users_rights`.`user_id` = '$user_id'                     AND `menu_is_active` = '1'                   ORDER BY `menu_sort_order` ASC";  //if($menu_parent_id == 0) echo $query_menus."<br>";  $result_menus = mysqli_query($db_link, $query_menus);  if (!$result_menus) echo mysqli_error($db_link);  if(mysqli_num_rows($result_menus) > 0) {    while ($menu_row = mysqli_fetch_assoc($result_menus)) {      $menu_id = $menu_row['menu_id'];      if(!empty($menu_id)) {        $menu_hierarchy_level = $menu_row['menu_hierarchy_level'];        $menu_has_children = $menu_row['menu_has_children'];        $menu_path_name = $menu_row['menu_path_name'];        $menu_name = $menu_row['menu_name'];        //$menu_name = $languages[$current_lang][$menu_name_variable];        $menu_url = (empty($menu_row['menu_url'])) ? "javascript:;" : $menu_row['menu_url'];        $menu_friendly_url = $menu_row['menu_friendly_url'];        $ul_class = "menu_ul_".($menu_hierarchy_level+1)."_level";        $li_class = "menu_li_".($menu_hierarchy_level+1)."_level";        $a_class = "menu_a_".($menu_hierarchy_level+1)."_level";        $user_access_sha1 = sha1($menu_id);        $menu_image_url = $menu_row['menu_image_url'];        $image_id = !empty($menu_friendly_url) ? " id='$menu_friendly_url'" : "";        if($menu_hierarchy_level == 0) {          switch($menu_friendly_url) {            case "languages" :      $menu_icon = '<i class="fa fa-language fa-2x menu_icon"></i>';              break;            case "content" :        $menu_icon = '<i class="fa fa-folder-open-o fa-2x menu_icon"></i>';              break;            case "catalog" :        $menu_icon = '<i class="fa fa-cart-plus fa-2x menu_icon"></i>';              break;            case "clients" :          $menu_icon = '<i class="fa fa-users fa-2x menu_icon"></i>';              break;            case "report" :         $menu_icon = '<i class="fa fa-bar-chart fa-2x menu_icon"></i>';              break;            case "slider" :         $menu_icon = '<i class="fa fa-film fa-2x menu_icon"></i>';              break;            case "galleries" :        $menu_icon = '<i class="fa fa-file-image-o fa-2x menu_icon"></i>';              break;            case "banners" :        $menu_icon = '<i class="fa fa-object-ungroup fa-2x menu_icon"></i>';              break;            case "events" :        $menu_icon = '<i class="fa fa-building-o fa-2x menu_icon"></i>';              break;            case "courses" :           $menu_icon = '<i class="fa fa-calendar fa-2x menu_icon"></i>';              break;            case "news" :           $menu_icon = '<i class="fa fa-newspaper-o fa-2x menu_icon"></i>';              break;            case "administration" : $menu_icon = '<i class="fa fa-user fa-2x menu_icon"></i>';              break;            default: $menu_icon = "";          }        }        else {          $menu_icon = '<i class="fa fa-caret-right"></i>';        }         $menu_show_in_menu = $menu_row['menu_show_in_menu'];        $li_class_visible = ($menu_show_in_menu == 1) ? "" : " hidden";        $menu_sort_order = $menu_row['menu_sort_order'];        $users_rights_edit = $menu_row['users_rights_edit'];        $users_rights_delete = $menu_row['users_rights_delete'];        $menu_has_active_children = false;        $menu_is_last_child = false;        if($menu_has_children == 1) $menu_has_active_children = check_if_menu_has_active_children($menu_id,$user_id);        if($menu_hierarchy_level > 0) $menu_is_last_child = check_if_this_is_menu_last_child($menu_parent_id,$menu_sort_order,$user_id);        if($menu_has_children == 1 && $menu_has_active_children) {          $down_arrow = ($menu_hierarchy_level == 0) ? '<i class="fa fa-chevron-down arrow_down"></i><i class="fa fa-chevron-up arrow_up"></i>' : "";          $li_class_active = (strpos($_SERVER['PHP_SELF'],$menu_path_name) !== false && ($menu_hierarchy_level == 0)) ? " active" : "";?>          <li<?=$image_id?> id="<?=$menu_friendly_url;?>" class="<?=$li_class.$li_class_active.$li_class_visible;?>">            <a href="<?=$menu_url;?>" user-rights-access="<?=$user_access_sha1;?>" user-access-edit="<?=$users_rights_edit;?>" user-access-delete="<?=$users_rights_delete;?>" class="<?=$a_class;?>">              <?=$menu_icon;?>              <span class="menu_text"><?=$menu_name;?></span>              <?=$down_arrow;?>            </a>            <ul class="<?=$ul_class;?>"><?php              print_html_admin_menu($menu_id, $user_id);        }        else {?>          <li<?=$image_id?> class="<?=$li_class.$li_class_visible;?><?php echo (strpos($_SERVER['PHP_SELF'],$menu_url) === false) ? NULL : " active"; ?>">            <a href="<?=$menu_url;?>" user-rights-access="<?=$user_access_sha1;?>" user-access-edit="<?=$users_rights_edit;?>" user-access-delete="<?=$users_rights_delete;?>" class="<?=$a_class;?>">              <?=$menu_icon;?>              <span class="menu_text"><?=$menu_name;?></span>            </a>          </li><?php         }                if($menu_hierarchy_level > 0 && $menu_is_last_child) echo "</ul></li>\n";      }    }    mysqli_free_result($result_menus);  }}  function print_html_admin_footer() {    global $db_link;  global $languages;  global $current_lang;?><!--footer-->  <footer>    <div class="inside_container">      <div id="rights">        <b>Kanisco  (<?=@date("Y");?>)</b>      </div>    </div>  </footer><!--footer-->  <script type="text/javascript">    $(document).ready(function() {      $(".row_over *").click(function() {        $(".row_over").removeClass("row_over_edit");        $(this).closest(".row_over").addClass("row_over_edit");      });      $("tr.even,tr.odd").mouseenter(function() {        var me = $(this);        me.addClass("hover");      });      $("tr.even,tr.odd").mouseleave(function() {        var me = $(this);        me.removeClass("hover");      });      if($(".menu_ul_1_level li.active").length) {        $(".menu_ul_1_level li.active").parent(".menu_ul_1_level").show();      }      if($(".menu_ul_2_level li.active").length) {        $(".menu_ul_2_level li.active").parent(".menu_ul_2_level").show();        $(".menu_ul_2_level li.active").parent(".menu_ul_2_level").parent(".menu_li_2_level").addClass("active");        $(".menu_ul_2_level li.active").parent(".menu_ul_2_level").parent(".menu_li_2_level").parent(".menu_ul_1_level").show();      }      $("nav a.menu_a_1_level").bind('click', function() {        var link = $(this);        var link_parent = link.parent(".menu_li_1_level");        if(link.hasClass("active")) {          link.removeClass("active");          link_parent.find("ul.menu_ul_1_level").slideUp();        }        else {          $("nav a.menu_a_1_level").removeClass("active");          $("nav li.menu_li_1_level").removeClass("active");          link.addClass("active");          $("nav").find("ul.menu_ul_1_level").slideUp();          link_parent.find("ul.menu_ul_1_level").slideDown();        }      });      $("nav a.menu_a_2_level").bind('click', function() {        var link = $(this);        var link_parent = link.parent(".menu_li_2_level");        if(link.hasClass("active")) {          link.removeClass("active");          link_parent.find("ul.menu_ul_2_level").slideUp();        }        else {          $("nav a.menu_a_2_level").removeClass("active");          $("nav li.menu_li_2_level").removeClass("active");          link.addClass("active");          link_parent.addClass("active");          $("nav").find("ul.menu_ul_2_level").slideUp();          link_parent.find("ul.menu_ul_2_level").slideDown();        }      });      $("#ajax_notification .close_warning").bind('click', function() {        $("#ajax_notification").slideUp(900);      });      $('#menu .open_close_nav').bind('click', function() {        var body = $("body");        if(body.hasClass("opened_nav")) {          body.removeClass("opened_nav").addClass("closed_nav");          createCookie('nav','closed_nav',2);        }        else {          body.removeClass("closed_nav").addClass("opened_nav");          createCookie('nav','opened_nav',2);        }      });    });  </script><?php  if(isset($db_link)) {    DB_CloseI($db_link);  }}function do_menu_management_page($first_iteration,$menu_id,$main_path_number) {    global $db_link;  global $languages;  global $current_lang;    $query_languages = "SELECT `language_id`,`language_code`,`language_name`,`language_is_default_backend`,`language_is_active`                       FROM `languages`                      ORDER BY `language_menu_order` ASC";  //echo $query_languages;exit;  $result_languages = mysqli_query($db_link, $query_languages);  if(!$result_languages) echo mysqli_error($db_link);  $language_count = mysqli_num_rows($result_languages);  if($language_count > 0) {    while($language_row = mysqli_fetch_assoc($result_languages)) {      $db_languages[] = $language_row;    }  }?><input type="hidden" id="current_page" value="<?=$_SERVER['PHP_SELF'];?>"><table>  <thead>    <tr>      <th width="4%"><?=$languages[$current_lang]['btn_save'];?></th>      <th width="5%" class="text_left"><?=$languages[$current_lang]['header_menu_number'];?></th>      <th width="15%" colspan="2"><?=$languages[$current_lang]['header_menu_name'];?></th>      <th width="14%"><?=$languages[$current_lang]['header_menu_parent'];?></th>      <th width="8%"><?=$languages[$current_lang]['header_menu_has_children'];?></th>      <th width="15%"><?=$languages[$current_lang]['header_menu_url_address'];?></th>      <th width="14%"><?=$languages[$current_lang]['header_menu_pretty_url'];?></th>      <th width="9%"><?=$languages[$current_lang]['header_menu_directory_path'];?></th>      <!--<th width="5%"><?=$languages[$current_lang]['header_menu_image'];?></th>-->      <th width="3%"><?=$languages[$current_lang]['header_menu_order'];?></th>      <th width="4%"><?=$languages[$current_lang]['header_menu_is_active'];?></th>      <th width="5%"><?=$languages[$current_lang]['header_menu_visible'];?></th>      <th width="4%"><?=$languages[$current_lang]['btn_delete'];?></th>    </tr>  </thead></table><div id="menu_list" class="margin_bottom"><?php  list_menu($menu_id,$main_path_number,$db_languages); ?>   </div><!--modal_confirm--><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_menu_link']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteMenuLink();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_menu_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_menu_link").click(function() {    $(".delete_menu_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><div id="add_menu" class="add_new_form">  <h3><?=$languages[$current_lang]['form_add_new'];?></h3>  <table>    <tr class="row_over">      <td width="4%">        <button class="btn_save" onClick="AddMenuLink();">          <?=$languages[$current_lang]['btn_save'];?>        </button>      </td>      <td width="5%">&nbsp;</td>      <td width="15%" colspan="2"><input type="text" name="add_menu_name" id="add_menu_name" /></td>      <td width="14%">        <select id="add_menu_parent_id">          <option value="0" level="-1"></option>          <?php list_menu_for_select_a_parent($parent_id = 0, $path_number = 0, $menu_parent_id = 0); ?>         </select>      </td>      <td width="8%">        <div class="checkbox">          <input type="checkbox" name="add_menu_has_children" id="add_menu_has_children" />        </div>      </td>      <td width="15%"><input type="text" name="add_menu_url" id="add_menu_url" /></td>      <td width="14%"><input type="text" name="add_menu_friendly_url" id="add_menu_friendly_url" /></td>      <td width="9%"><input type="text" name="add_menu_path_name" id="add_menu_path_name" /></td>      <td width="0%" class="hidden"><input type="text" name="add_menu_image_url" id="add_menu_image_url" /></td>      <td width="3%"><input type="text" name="add_menu_sort_order" id="add_menu_sort_order" /></td>      <td width="4%">        <div class="checkbox">          <input type="checkbox" name="add_menu_is_active" id="add_menu_is_active" />        </div>      </td>      <td width="5%">        <div class="checkbox">          <input type="checkbox" name="add_menu_show_in_menu" id="add_menu_show_in_menu" />        </div>      </td>      <td width="4%"></td>    </tr>  </table></div><div class="clearfix"></div><?php}function list_menu($menu_id,$main_path_number,$db_languages) {      global $db_link;  global $first_iteration;  global $languages;  global $current_lang;  global $class;  if($first_iteration) {    $query_menus = "SELECT `menus`.* FROM `menus` WHERE `menu_id` = '$menu_id' ORDER BY `menu_sort_order` ASC";  }  else {    $query_menus = "SELECT `menus`.* FROM `menus` WHERE `menu_parent_id` = '$menu_id' ORDER BY `menu_sort_order` ASC";  }  //if($menu_id == 34) echo $query_menus;  $first_iteration = false;  $result_menus = mysqli_query($db_link,$query_menus);  if (!$result_menus) echo mysqli_error($db_link);  if(mysqli_num_rows($result_menus) > 0) {    while ($menus = mysqli_fetch_assoc($result_menus)) {      $menu_id = $menus['menu_id'];      $menu_parent_id = $menus['menu_parent_id'];      $menu_path_name = $menus['menu_path_name'];      $menu_name = stripslashes($menus['menu_name']);      $menu_url = $menus['menu_url'];      $menu_hierarchy_level = $menus['menu_hierarchy_level'];      $menu_has_children = $menus['menu_has_children'];      $menu_friendly_url = $menus['menu_friendly_url'];      $menu_image_url = $menus['menu_image_url'];      $menu_sort_order = $menus['menu_sort_order'];      $menu_show_in_menu = $menus['menu_show_in_menu'];      $menu_is_active = $menus['menu_is_active'];      if ($menu_hierarchy_level == 0) {          $main_path_number++;          $main_option_path_number = (isset($main_option_path_number)) ? $main_path_number : $menu_sort_order;      } else {          $main_option_path_number = "&dash;$main_path_number.$menu_sort_order";      }      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");      ?>      <div id="menu<?=$menu_id;?>" class="row_over menu_hierarchy_level_<?=$menu_hierarchy_level;?>">        <table>          <tr class="<?=$class;?>">            <td width="4%">              <button class="btn_save" onClick="EditMenuLink('<?=$menu_id;?>')">                <?=$languages[$current_lang]['btn_save'];?>              </button>            </td>            <td width="5%" class="text_left"><b><?=$main_option_path_number;?></b></td>            <td width="12%"><input type="text" name="menu_name" class="menu_name" value="<?=$menu_name;?>" /></td>            <td width="3%"><button class="show_menu_translation btn_toggle" onClick="ToggleMenuTranslation(this,'<?=$menu_id;?>')">+</button></td>            <td width="14%">              <select class="menu_parent_id">                <option value="0" level="-1"></option>                <?php list_menu_for_select_a_parent($parent_id = 0, $path_number = 0, $menu_parent_id);?>              </select>            </td>            <td width="8%">              <div class="checkbox<?php if ($menu_has_children == 1) echo ' checkbox_checked';?>">                <input type="checkbox" name="menu_has_children" class="menu_has_children" onClick="Checkbox(this)" <?php if ($menu_has_children == 1) echo 'checked="checked"';?> />              </div>            </td>            <td width="15%"><input type="text" name="menu_url" class="menu_url" value="<?=$menu_url;?>" /></td>            <td width="14%"><input type="text" name="menu_friendly_url" class="menu_friendly_url" value="<?=$menu_friendly_url;?>" /></td>            <td width="9%"><input type="text" name="menu_path_name" class="menu_path_name" value="<?=$menu_path_name;?>" /></td>            <td width="5%" class="hidden"><input type="text" name="menu_image_url" class="menu_image_url" value="<?=$menu_image_url;?>" /></td>            <td width="3%"><input type="text" name="menu_sort_order" class="menu_sort_order" value="<?=$menu_sort_order;?>" /></td>            <td width="4%">              <div class="checkbox<?php if ($menu_is_active == 1) echo ' checkbox_checked';?>">                <input type="checkbox" name="menu_is_active" class="menu_is_active" onClick="Checkbox(this)" <?php if ($menu_is_active == 1) echo 'checked="checked"';?> />              </div>            </td>            <td width="5%">              <div class="checkbox<?php if ($menu_show_in_menu == 1) echo ' checkbox_checked';?>">                <input type="checkbox" name="menu_show_in_menu" class="menu_show_in_menu" onClick="Checkbox(this)" <?php if ($menu_show_in_menu == 1) echo 'checked="checked"';?> />              </div>            </td>            <td width="4%">              <a href="javascript:;" class="delete_menu_link" data-id="<?=$menu_id;?>">                <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />              </a>            </td>          </tr>        </table>      </div>      <div class="menu_translation_row menu_translation_row_<?=$menu_id;?>" style="display: none;padding-bottom: 10px;">        <table><?php        foreach($db_languages as $language) {          $language_id = $language['language_id'];          $language_code = $language['language_code'];          $language_name = $language['language_name'];          $menu_translation_text = "";          $query = "SELECT `menu_translation_text` FROM `menus_translations` WHERE `menu_id` = '$menu_id' AND `language_id` = '$language_id'";          $result = mysqli_query($db_link,$query);          if(!$result) echo mysqli_error($db_link);          else {            $row = mysqli_fetch_assoc($result);            $menu_translation_text = $row['menu_translation_text'];          }          if(empty($menu_translation_text)) $onclick_func = "AddMenuTranslation";          else $onclick_func = "EditMenuTranslation";                    $language_flag = "/_admin/images/flags/$language_code.png";          $language_flag_params = getimagesize($_SERVER['DOCUMENT_ROOT'].$language_flag);          $language_flag_dimensions = $language_flag_params[3];?>          <tr id="menu_translation_<?="$menu_id$language_id";?>">            <td width="4%">              <button class="btn_save" onClick="<?=$onclick_func;?>('<?=$menu_id;?>','<?=$language_id;?>')">                <?=$languages[$current_lang]['btn_save'];?>              </button>            </td>            <td width="5%">              <img src="/_admin/images/flags/<?=$language_code;?>.png" <?=$language_flag_dimensions;?> alt="<?=$language_name;?>" title="<?=$language_name;?>" />            </td>            <td width="30%"><input type="text" class="menu_translation_text" value="<?=stripslashes($menu_translation_text);?>" /></td>            <td></td>          </tr><?php         }?>          </table>        </div><?php      list_menu($menu_id, $main_option_path_number,$db_languages);    }  }}function list_menu_for_select_a_parent($parent_id, $path_number, $menu_parent_id) {      global $db_link;    global $languages;    global $current_lang;      $query = "SELECT `menus`.* FROM `menus` WHERE `menu_parent_id` = '$parent_id' ORDER BY `menu_sort_order` ASC";    //echo $query;    $result = mysqli_query($db_link, $query);    if (!$result) echo mysqli_error($db_link);    if(mysqli_num_rows($result) > 0) {        while ($row = mysqli_fetch_assoc($result)) {            $parent_id = $row['menu_id'];            $parent_name = stripslashes($row['menu_name']);            //$parent_name = $languages[$current_lang][$parent_name];            $parent_level = $row['menu_hierarchy_level'];            $parent_sort = $row['menu_sort_order'];            if ($parent_level == 0) {                $path_number++;                $option_path_number = (isset($option_path_number)) ? $path_number : $parent_sort;            } else {                $option_path_number = "&nbsp;$path_number.$parent_sort";            }            if ($menu_parent_id == $parent_id)                $selected = 'selected="selected"';            else                $selected = "";            echo "<option value=\"$parent_id\" level=\"$parent_level\" $selected>$option_path_number. $parent_name</option>";            list_menu_for_select_a_parent($parent_id, $option_path_number, $menu_parent_id);        }    }}function list_contents($parent_id, $path_number) {    global $db_link;  global $languages;  global $current_lang;  global $class;  $query_content = "SELECT `contents`.`content_id`,`contents`.`content_parent_id`,`contents`.`content_hierarchy_path`,`contents`.`content_is_default`, `content_is_home_page`,                          `contents`.`content_has_children`,`contents`.`content_name`,`contents`.`content_hierarchy_level`,`contents`.`content_menu_order`,                          `contents`.`content_collapsed`,`contents`.`content_text`,`contents`.`content_pretty_url`,`contents`.`content_is_active`,`contents_types`.*                    FROM `contents`                    INNER JOIN `contents_types` ON `contents_types`.`content_type_id` = `contents`.`content_type_id`                    WHERE `contents`.`content_parent_id` = '$parent_id'                    ORDER BY `content_menu_order` ASC";  //echo $query_content;exit;  $result_content = mysqli_query($db_link, $query_content);  if(!$result_content) echo mysqli_error($db_link);  $content_count = mysqli_num_rows($result_content);  if($content_count > 0) {    $key = 0;    $warning_cannot_change_language = $languages[$current_lang]['warning_cannot_change_language'];    while($content_row = mysqli_fetch_assoc($result_content)) {      $content_id = $content_row['content_id'];      $content_parent_id = $content_row['content_parent_id'];      $content_hierarchy_path = $content_row['content_hierarchy_path'];      $content_is_default = $content_row['content_is_default'];      $content_is_home_page = $content_row['content_is_home_page'];      $content_type_id = $content_row['content_type_id'];      $content_type = $content_row['content_type'];      $content_type_lang = $languages[$current_lang][$content_type];      $content_hierarchy_level = $content_row['content_hierarchy_level'];      $content_has_children = $content_row['content_has_children'];      $content_name = $content_row['content_name'];      $content_collapsed = $content_row['content_collapsed'];      $content_text = $content_row['content_text'];      $content_url = ($content_type_id == 4) ? $content_text : "/$content_hierarchy_path";      $content_pretty_url = $content_row['content_pretty_url'];      $content_menu_order = $content_row['content_menu_order'];      $content_is_active = $content_row['content_is_active'];      $set_content = ($content_is_active == 1) ? 0 : 1;      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");      $name_dashes = "";      if($content_hierarchy_level == 1) {          $path_number++;          $content_path_number = $path_number;      } else {          $content_path_number = "$path_number.$content_menu_order";          if($content_hierarchy_level == 2) $name_dashes = "- ";          if($content_hierarchy_level == 3) $name_dashes = "- - ";          if($content_hierarchy_level == 4) $name_dashes = "- - - ";          if($content_hierarchy_level == 5) $name_dashes = "- - - - ";      }      $edit_link = ($content_type_id == 6) ? "javascript:alert('$warning_cannot_change_language');" : "/_admin/content/content-details.php?content_id=$content_id";?>      <table class="row_over">        <tbody>          <tr id="tr_<?=$content_id;?>" class="<?=$class?>">            <td width="2%" class="text_left">              <a href="javascript:;" onclick="ToggleExpandContent('<?=$content_id;?>', '<?php if($content_collapsed == 1) echo "expand"; else echo "collapse" ?>');">                <?php                   if($content_has_children == 0) {                    // no children, print nothing                  } else {                      if($content_collapsed == 0) { ?>                      <img src="/_admin/images/contract.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_collapse_section'];?>" title="<?=$languages[$current_lang]['title_collapse_section'];?>" width="16" height="16" />                    <?php } else { ?>                      <img src="/_admin/images/expand.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_open_section'];?>" title="<?=$languages[$current_lang]['title_open_section'];?>" width="16" height="16" />                    <?php                     }                   }                ?>              </a>            </td>            <td width="5%" class="text_left"><?=$content_path_number;?></td>            <td width="25%" class="text_left">              <a href="<?=$edit_link;?>" class="red_link"><?php echo "$name_dashes $content_name";?></a>            </td>            <td width="15%" class="text_left"><?=$content_pretty_url;?></td>            <td width="10%"><?=$content_type_lang;?></td>            <td width="5%">              <a href="javascript:;" onclick="SetContentActiveInactive(this,'<?=$content_id;?>', '<?=$set_content;?>')">                <?php if($content_is_active == 1) { ?>                  <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate_content'];?>" title="<?=$languages[$current_lang]['title_deactivate_content'];?>" width="16" height="16" />                <?php } else { ?>                  <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate_content'];?>" title="<?=$languages[$current_lang]['title_activate_content'];?>" width="16" height="16" />                <?php } ?>              </a>            </td>            <td width="5%">                <?php if($content_is_home_page == 1) { ?>                  <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_content_is_default'];?>" title="<?=$languages[$current_lang]['title_home_page_content'];?>" width="16" height="16" />                <?php } else { ?>                <a href="javascript:;" onclick="if(confirm('<?php echo $languages[$current_lang]['set_content_default_warning_1']." $content_name ".$languages[$current_lang]['set_content_default_warning_2'];?>')) SetContentAsHomePage('<?=$content_id;?>');">                  <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_set_content_default'];?>" title="<?=$languages[$current_lang]['title_set_content_default'];?>" width="16" height="16" />                </a>                <?php } ?>            </td>            <td width="10%">                <?php if($content_is_default == 1) { ?>                  <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_content_is_default'];?>" title="<?=$languages[$current_lang]['title_content_is_default'];?>" width="16" height="16" />                <?php } else { ?>                <a href="javascript:;" onclick="if(confirm('<?php echo $languages[$current_lang]['set_content_default_warning_1']." $content_name ".$languages[$current_lang]['set_content_default_warning_2'];?>')) SetContentDefault('<?=$content_id;?>');">                  <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_set_content_default'];?>" title="<?=$languages[$current_lang]['title_set_content_default'];?>" width="16" height="16" />                </a>                <?php } ?>            </td>            <td width="7%">              <?php                // if($content_count > 1) we gonna give the appropriate moveing options                // else we gonna leave this empty                if($content_count > 1) {                   if($key == 0) {              ?>                  <a href="javascript:;" onclick="MoveContentForwardBackward('<?=$content_id;?>','<?=$content_parent_id;?>','<?=$content_menu_order;?>','<?=$content_hierarchy_level;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_content_backward'];?>" title="<?=$languages[$current_lang]['title_move_content_backward'];?>" width="16" height="16" />                  </a>                <?php } elseif($key == $content_count-1) { ?>                  <a href="javascript:;" onclick="MoveContentForwardBackward('<?=$content_id;?>','<?=$content_parent_id;?>','<?=$content_menu_order;?>','<?=$content_hierarchy_level;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_content_forward'];?>" title="<?=$languages[$current_lang]['title_move_content_forward'];?>" width="16" height="16" />                  </a>                <?php } else { ?>                  <a href="javascript:;" onclick="MoveContentForwardBackward('<?=$content_id;?>','<?=$content_parent_id;?>','<?=$content_menu_order;?>','<?=$content_hierarchy_level;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_content_backward'];?>" title="<?=$languages[$current_lang]['title_move_content_backward'];?>" width="16" height="16" />                  </a>                  <a href="javascript:;" onclick="MoveContentForwardBackward('<?=$content_id;?>','<?=$content_parent_id;?>','<?=$content_menu_order;?>','<?=$content_hierarchy_level;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_content_forward'];?>" title="<?=$languages[$current_lang]['title_move_content_forward'];?>" width="16" height="16" />                  </a>              <?php                   }                } // if($content_count > 1)              ?>            </td>            <td width="4%">              <a href="<?=$content_url;?>" target="_blank">                <img src="/_admin/images/view.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_view_content'];?>" title="<?=$languages[$current_lang]['title_view_content'];?>" width="16" height="16" />              </a>            </td>            <td width="4%">              <a href="<?=$edit_link;?>">                <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit_content'];?>" title="<?=$languages[$current_lang]['title_edit_content'];?>" width="16" height="16" />              </a>            </td>            <td width="4%">            <?php if($content_has_children == 0) { ?>              <a href="javascript:;" class="delete_content_link" data-id="<?=$content_id;?>" data-parent="<?=$content_parent_id;?>">                <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete_content'];?>" title="<?=$languages[$current_lang]['title_delete_content'];?>" width="16" height="16" />              </a>            <?php } ?>            </td>            <td width="4%">              <input type="checkbox" class="multicontent" value="<?=$content_id;?>" name="multicontent[]" title="<?=$languages[$current_lang]['title_toggle_checkbox'];?>"/>            </td>          </tr>        </tbody>      </table><?php      if($content_collapsed == 0 && $content_has_children == 1) {        list_contents($content_id, $content_path_number);      }      $key++;    }    mysqli_free_result($result_content);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_content_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteContent();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_content_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_content_link").click(function() {    $(".delete_content_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_contents_for_select($parent_id, $path_number, $content_parent_id, $current_content_id) {    global $db_link;  global $get_only_content_type_language; // if content_type is error_page, we need only the root parents i.e. languages (`content_type_id` = '6') if any  if(isset($get_only_content_type_language)) {    $query = "SELECT `content_id`, `content_name`, `content_hierarchy_level`, `content_menu_order`               FROM `contents`               WHERE `content_type_id` = '6'               ORDER BY `content_menu_order` ASC";  }  else {    $query = "SELECT `content_id`, `content_name`, `content_hierarchy_level`, `content_menu_order`               FROM `contents`               WHERE `content_parent_id` = '$parent_id'               ORDER BY `content_menu_order` ASC";  }  //echo $query;  $result = mysqli_query($db_link, $query);  if (!$result) echo mysqli_error($db_link);  if(mysqli_num_rows($result) > 0) {    while ($row = mysqli_fetch_assoc($result)) {      $parent_id = $row['content_id'];      $parent_name = stripslashes($row['content_name']);      $content_hierarchy_level = $row['content_hierarchy_level'];       $content_menu_order = $row['content_menu_order'];      if($content_hierarchy_level == 1) {          $path_number++;          $option_path_number = $path_number;      } else {          $option_path_number = "&nbsp;$path_number. $content_menu_order";      }      if ($content_parent_id == $parent_id)          $selected = 'selected="selected"';      else          $selected = "";      if($current_content_id != $parent_id) {                echo "<option value='$parent_id.$content_hierarchy_level' level='$content_hierarchy_level' $selected>$option_path_number. $parent_name</option>";              if(!isset($get_only_content_type_language)) list_contents_for_select($parent_id, $option_path_number, $content_parent_id, $current_content_id);      }     }    mysqli_free_result($result);  }}function list_contents_for_reorder($parent_id, $path_number) {    global $db_link;  $query = "SELECT `content_id`, `content_name`, `content_hierarchy_level`, `content_has_children`, `content_menu_order`, `content_pretty_url`             FROM `contents`             WHERE `content_parent_id` = '$parent_id'             ORDER BY `content_menu_order` ASC";  //echo $query;  $result = mysqli_query($db_link, $query);  if (!$result) echo mysqli_error($db_link);  if(mysqli_num_rows($result) > 0) {        if($parent_id == 0) {      echo "<ul class='sortable sortable_list'>";    }    while ($row = mysqli_fetch_assoc($result)) {      $content_id = $row['content_id'];      $parent_id = $content_id;      $parent_name = stripslashes($row['content_name']);      $content_hierarchy_level = $row['content_hierarchy_level'];      $content_has_children = $row['content_has_children'];      $content_menu_order = $row['content_menu_order'];      $content_pretty_url = $row['content_pretty_url'];      if($content_hierarchy_level == 1) {          $path_number++;          $option_path_number = $path_number;      } else {          $option_path_number = "&nbsp;$path_number.$content_menu_order";      }            $class_expanded_leaf = ($content_has_children == 1) ? "mjs-nestedSortable-branch mjs-nestedSortable-expanded" : "mjs-nestedSortable-leaf";      $expand_collapse_node = ($content_has_children == 1) ? "<span title='Click to show/hide children' class='disclose ui-icon ui-icon-minusthick'><span></span></span>" : "";      echo "<li id='content_$content_id' class='$class_expanded_leaf' data-id='$content_id'><div class='label'>$expand_collapse_node$option_path_number. $parent_name<em>($content_pretty_url)</em></div>";      if($content_has_children == 1) {        echo "<ul class='sortable_list'>";                list_contents_for_reorder($parent_id, $option_path_number);                echo "</ul>";      }            echo "</li>";    }        mysqli_free_result($result);  }  else {    echo "</ul>";  }}function list_categories_for_select($parent_id, $path_number, $category_parent_id, $current_category_id) {    global $db_link;    $query = "SELECT `categories`.*, `category_descriptions`.`cd_name`             FROM `categories`             INNER JOIN `category_descriptions` USING(`category_id`)            INNER JOIN `languages` USING(`language_id`)            WHERE `categories`.`category_parent_id` = '$parent_id' AND `languages`.`language_is_default_backend` = '1'             ORDER BY `category_sort_order` ASC";  //echo $query;  $result = mysqli_query($db_link, $query);  if (!$result) echo mysqli_error($db_link);  if(mysqli_num_rows($result) > 0) {    while ($row = mysqli_fetch_assoc($result)) {      $parent_id = $row['category_id'];      $parent_name = stripslashes($row['cd_name']);      $category_hierarchy_level = $row['category_hierarchy_level'];      $category_sort_order = $row['category_sort_order'];      if($category_hierarchy_level == 1) {          $path_number++;          $option_path_number = $path_number;      } else {          $option_path_number = "&nbsp;$path_number. $category_sort_order";      }      if ($category_parent_id == $parent_id)          $selected = 'selected="selected"';      else          $selected = "";      if($current_category_id != $parent_id) {                echo "<option value='$parent_id.$category_hierarchy_level' level='$category_hierarchy_level' $selected>$option_path_number. $parent_name</option>";              list_categories_for_select($parent_id, $option_path_number, $category_parent_id, $current_category_id);      }     }    mysqli_free_result($result);  }}function list_categories_in_select_for_products($category_id, $path_number) {    global $db_link;  global $exclude_categories_array; // for products-attributes-group-details.php    $query = "SELECT `categories`.`category_id`,`categories`.`category_hierarchy_level`,`categories`.`category_sort_order`,                    `categories`.`category_has_children`,`category_descriptions`.`cd_name`             FROM `categories`             INNER JOIN `category_descriptions` USING(`category_id`)            INNER JOIN `languages` USING(`language_id`)            WHERE `categories`.`category_parent_id` = '$category_id' AND `languages`.`language_is_default_backend` = '1'             ORDER BY `category_sort_order` ASC";  //echo $query;  $result = mysqli_query($db_link, $query);  if (!$result) echo mysqli_error($db_link);  if(mysqli_num_rows($result) > 0) {    while ($row = mysqli_fetch_assoc($result)) {      $category_id = $row['category_id'];      $parent_name = stripslashes($row['cd_name']);      $category_hierarchy_level = $row['category_hierarchy_level'];      $category_sort_order = $row['category_sort_order'];      $category_has_children = $row['category_has_children'];      if($category_hierarchy_level == 1) {          $path_number++;          $option_path_number = $path_number;      } else {          $option_path_number = "&nbsp;$path_number. $category_sort_order";      }              if(isset($exclude_categories_array)) {        if(!in_array($category_id, $exclude_categories_array)) {          echo "<option value='$category_id-$parent_name' data-choose='$category_has_children'>$option_path_number. $parent_name</option>";          list_categories_in_select_for_products($category_id, $option_path_number);        }      }      else {        echo "<option value='$category_id-$parent_name' data-choose='$category_has_children'>$option_path_number. $parent_name</option>";        list_categories_in_select_for_products($category_id, $option_path_number);      }    }    mysqli_free_result($result);  }}function list_categories($parent_id, $path_number) {    global $db_link;  global $languages;  global $current_lang;  global $class;  $query_categories = "SELECT `categories`.`category_id`,`categories`.`category_parent_id`,`categories`.`category_hierarchy_level`,                              `categories`.`category_is_active`,`categories`.`category_sort_order`,`categories`.`category_has_children`,                              `categories`.`category_is_collapsed`,`category_descriptions`.`cd_name`                       FROM `categories`                      INNER JOIN `category_descriptions` USING(`category_id`)                      INNER JOIN `languages` USING(`language_id`)                      WHERE `categories`.`category_parent_id` = '$parent_id' AND `languages`.`language_is_default_backend` = '1'                      ORDER BY `categories`.`category_sort_order` ASC";  //echo $query_content;exit;  $result_categories = mysqli_query($db_link, $query_categories);  if(!$result_categories) echo mysqli_error($db_link);  $category_count = mysqli_num_rows($result_categories);  if($category_count > 0) {    $key = 0;    while($category_row = mysqli_fetch_assoc($result_categories)) {      $category_id = $category_row['category_id'];      $category_parent_id = $category_row['category_parent_id'];      $cd_name = $category_row['cd_name'];      $category_hierarchy_level = $category_row['category_hierarchy_level'];      $category_sort_order = $category_row['category_sort_order'];      $category_is_active = $category_row['category_is_active'];      $category_has_children = $category_row['category_has_children'];      $category_is_collapsed = $category_row['category_is_collapsed'];      $set_category = ($category_is_active == 1) ? 0 : 1;      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");      $name_dashes = "";      if($category_hierarchy_level == 1) {          $path_number++;          $category_path_number = $path_number;      } else {          $category_path_number = "$path_number.$category_sort_order";          if($category_hierarchy_level == 2) $name_dashes = "- ";          if($category_hierarchy_level == 3) $name_dashes = "- - ";          if($category_hierarchy_level == 4) $name_dashes = "- - - ";          if($category_hierarchy_level == 5) $name_dashes = "- - - - ";      }?>      <table class="row_over">        <tbody>          <tr id="tr_<?=$category_id;?>" class="<?=$class?>">            <td width="2%" class="text_left">              <a href="javascript:;" onclick="ToggleExpandCategory('<?=$category_id;?>', '<?php if($category_is_collapsed == 1) echo "expand"; else echo "collapse" ?>');">                <?php                   if($category_has_children == 0) {                    // no children, print nothing                  } else {                      if($category_is_collapsed == 0) { ?>                      <img src="/_admin/images/contract.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_collapse_section'];?>" title="<?=$languages[$current_lang]['title_collapse_section'];?>" width="16" height="16" />                    <?php } else { ?>                      <img src="/_admin/images/expand.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_open_section'];?>" title="<?=$languages[$current_lang]['title_open_section'];?>" width="16" height="16" />                    <?php                     }                   }                ?>              </a>            </td>            <td width="5%" class="text_left"><?=$category_path_number;?></td>            <td width="60%" class="text_left">              <a href="/_admin/catalog/category-details.php?category_id=<?=$category_id;?>" class="red_link"><?=$name_dashes.$cd_name;?></a>            </td>            <td width="5%">              <a href="javascript:;" onclick="SetCategoryActiveInactive(this,'<?=$category_id;?>', '<?=$set_category;?>')">                <?php if($category_is_active == 1) { ?>                  <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate_category'];?>" title="<?=$languages[$current_lang]['title_deactivate_category'];?>" width="16" height="16" />                <?php } else { ?>                  <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate_category'];?>" title="<?=$languages[$current_lang]['title_activate_category'];?>" width="16" height="16" />                <?php } ?>              </a>            </td>            <td width="14%">              <?php                // if($category_count > 1) we gonna give the appropriate moving options                // else we gonna leave this empty                if($category_count > 1) {                  if($key == 0) {              ?>                  <a href="javascript:;" onclick="MoveCategoryForwardBackward('<?=$category_id;?>','<?=$category_parent_id;?>','<?=$category_sort_order;?>','<?=$category_hierarchy_level;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_category_backward'];?>" title="<?=$languages[$current_lang]['title_move_category_backward'];?>" width="16" height="16" />                  </a>                <?php } elseif($key == $category_count-1) { ?>                  <a href="javascript:;" onclick="MoveCategoryForwardBackward('<?=$category_id;?>','<?=$category_parent_id;?>','<?=$category_sort_order;?>','<?=$category_hierarchy_level;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_category_forward'];?>" title="<?=$languages[$current_lang]['title_move_category_forward'];?>" width="16" height="16" />                  </a>                <?php } else { ?>                  <a href="javascript:;" onclick="MoveCategoryForwardBackward('<?=$category_id;?>','<?=$category_parent_id;?>','<?=$category_sort_order;?>','<?=$category_hierarchy_level;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_category_backward'];?>" title="<?=$languages[$current_lang]['title_move_category_backward'];?>" width="16" height="16" />                  </a>                  <a href="javascript:;" onclick="MoveCategoryForwardBackward('<?=$category_id;?>','<?=$category_parent_id;?>','<?=$category_sort_order;?>','<?=$category_hierarchy_level;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_category_forward'];?>" title="<?=$languages[$current_lang]['title_move_category_forward'];?>" width="16" height="16" />                  </a>              <?php                   }                } // if($category_count > 1)              ?>            </td>            <td width="7%">              <a href="/_admin/catalog/category-details.php?category_id=<?=$category_id;?>">                <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit_category'];?>" title="<?=$languages[$current_lang]['title_edit_category'];?>" width="16" height="16" />              </a>            </td>            <td width="7%">            <?php if($category_has_children == 0) { ?>              <a href="javascript:;" class="delete_category_link" data-id="<?=$category_id;?>" data-parent="<?=$category_parent_id;?>">                <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete_category'];?>" title="<?=$languages[$current_lang]['title_delete_category'];?>" width="16" height="16" />              </a>            <?php } ?>            </td>          </tr>        </tbody>      </table><?php      if($category_is_collapsed == 0 && $category_has_children == 1) {        list_categories($category_id, $category_path_number, $class);      }      $key++;    }    mysqli_free_result($result_categories);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_category_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteCategory();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_category_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_category_link").click(function() {    $(".delete_category_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }  else echo "<tr class='even'><td width='20%' class='text_left'>".$languages[$current_lang]['no_categories_in_the_database_yet']."</td><td colspan='6'>&nbsp;</td></tr>";}function list_categories_for_products($category_ids_array,$parent_id, $path_number) {    global $db_link;  global $languages;  global $current_lang;  $query_categories = "SELECT `categories`.`category_id`,`categories`.`category_hierarchy_level`,`categories`.`category_has_children`,                              `category_descriptions`.`cd_name`                       FROM `categories`                      INNER JOIN `category_descriptions` USING(`category_id`)                      INNER JOIN `languages` USING(`language_id`)                      WHERE `categories`.`category_parent_id` = '$parent_id' AND `languages`.`language_is_default_backend` = '1'                      ORDER BY `categories`.`category_sort_order` ASC";  //echo $query_content;exit;  $result_categories = mysqli_query($db_link, $query_categories);  if(!$result_categories) echo mysqli_error($db_link);  $category_count = mysqli_num_rows($result_categories);  if($category_count > 0) {    while($category_row = mysqli_fetch_assoc($result_categories)) {      $category_id = $category_row['category_id'];      $category_hierarchy_level = $category_row['category_hierarchy_level'];      $category_has_children = $category_row['category_has_children'];      $cd_name = $category_row['cd_name'];      if($category_has_children == 1) {        $onclick_fn = "GetSubcategories('$category_id')";      }      else {        $onclick_fn = "GetProductsByCategory('$category_id')";      }      if(!empty($category_ids_array)) {        $first_level_category_id = $category_ids_array[0];        $ids_count = count($category_ids_array)-1;        $current_category_id = $category_ids_array[$ids_count];      }      else {        $first_level_category_id = 0;        $current_category_id = 0;      }?>      <tr>        <td class="text_left">          <a id="link_<?=$category_id;?>" href="javascript:;" onClick="<?=$onclick_fn;?>" data-id="<?=$category_id;?>" data-ids="<?="$parent_id,$category_id";?>" data-h-level="<?=$category_hierarchy_level;?>" class="red_link"><?=$cd_name;?></a>        </td>      </tr><?php      if($first_level_category_id == 0 && $current_category_id != 0) {        if($current_category_id == $category_id) {?>        <script type='text/jscript'>          GetProductsByCategory('<?=$current_category_id;?>');        </script><?php        }      }      else {        if($first_level_category_id == $category_id) {?>        <script type='text/jscript'>          GetSubcategories('<?=$first_level_category_id;?>','<?=$current_category_id;?>');        </script><?php        }      }    } //while($category_row)    mysqli_free_result($result_categories);  }  else echo "<tr><td>".$languages[$current_lang]['no_categories_in_the_database_yet']."</td></tr>";}function list_categories_for_add_product($parent_id, $path_number) {    global $db_link;  global $languages;  global $current_lang;  $query_categories = "SELECT `categories`.`category_id`,`categories`.`category_parent_id`,`categories`.`category_hierarchy_level`,                              `categories`.`category_is_active`,`categories`.`category_sort_order`,`categories`.`category_has_children`,                              `categories`.`category_is_collapsed`,`category_descriptions`.`cd_name`                       FROM `categories`                      INNER JOIN `category_descriptions` USING(`category_id`)                      INNER JOIN `languages` USING(`language_id`)                      WHERE `categories`.`category_parent_id` = '$parent_id' AND `languages`.`language_is_default_backend` = '1'                      ORDER BY `categories`.`category_sort_order` ASC";  //echo $query_content;exit;  $result_categories = mysqli_query($db_link, $query_categories);  if(!$result_categories) echo mysqli_error($db_link);  $category_count = mysqli_num_rows($result_categories);  if($category_count > 0) {    $key = 0;    while($category_row = mysqli_fetch_assoc($result_categories)) {      $category_id = $category_row['category_id'];      $category_parent_id = $category_row['category_parent_id'];      $cd_name = $category_row['cd_name'];      $category_hierarchy_level = $category_row['category_hierarchy_level'];      $category_sort_order = $category_row['category_sort_order'];      $category_is_active = $category_row['category_is_active'];      $category_has_children = $category_row['category_has_children'];      $category_is_collapsed = $category_row['category_is_collapsed'];      $set_category = ($category_is_active == 1) ? 0 : 1;      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");      $name_dashes = "";      if($category_hierarchy_level == 1) {          $path_number++;          $category_path_number = $path_number;      } else {          $category_path_number = "$path_number.$category_sort_order";          if($category_hierarchy_level == 2) $name_dashes = "- ";          if($category_hierarchy_level == 3) $name_dashes = "- - ";          if($category_hierarchy_level == 4) $name_dashes = "- - - ";          if($category_hierarchy_level == 5) $name_dashes = "- - - - ";      }            $links_href = "/_admin/catalog/products-add-new.php?category_id=$category_id&category_name=$cd_name";?>      <tr id="tr_<?=$category_id;?>" class="<?=$class?>">        <td width="2%" class="text_left">          <a href="javascript:;" onclick="ToggleExpandCategory('<?=$category_id;?>', '<?php if($category_is_collapsed == 1) echo "expand"; else echo "collapse" ?>');">            <?php               if($category_has_children == 0) {                // no children, print nothing              } else {                  if($category_is_collapsed == 0) { ?>                  <img src="/_admin/images/contract.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_collapse_section'];?>" title="<?=$languages[$current_lang]['title_collapse_section'];?>" width="16" height="16" />                <?php } else { ?>                  <img src="/_admin/images/expand.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_open_section'];?>" title="<?=$languages[$current_lang]['title_open_section'];?>" width="16" height="16" />                <?php                 }               }            ?>          </a>        </td>        <td width="5%" class="text_left"><?=$category_path_number;?></td>        <td width="60%" class="text_left">          <a href="<?=$links_href;?>" class="red_link"><?=$name_dashes.$cd_name;?></a>        </td>        <td>&nbsp;</td>      </tr><?php      if($category_is_collapsed == 0 && $category_has_children == 1) {        list_categories_for_add_product($category_id, $category_path_number);      }      $key++;    }    mysqli_free_result($result_categories);  }  else echo "<tr class='even'><td width='20%' class='text_left'>".$languages[$current_lang]['no_categories_in_the_database_yet']."</td><td colspan='6'>&nbsp;</td></tr>";}function list_products($category_ids_list,$current_category_id, $first_iteration) {    global $db_link;  global $languages;  global $current_lang;  global $current_language_id;  $first_iteration = false;        $query_products = "SELECT `products`.`product_id`,`products`.`product_sort_order`,`products`.`product_is_active`,                            `product_description`.`pd_name`                       FROM `products`                      INNER JOIN `product_to_category` USING(`product_id`)                      INNER JOIN `product_description` USING(`product_id`)                      WHERE `product_to_category`.`category_id` = '$current_category_id'                         AND `product_description`.`language_id` = '$current_language_id'                      ORDER BY `product_description`.`pd_name` ASC";  //echo $query_products."<br>";exit;  $result_products = mysqli_query($db_link, $query_products);  if(!$result_products) echo mysqli_error($db_link);  $products_count = mysqli_num_rows($result_products);  if($products_count > 0) {    $key = 0;    $page_offset = 60;    if($products_count > $page_offset) {      $page_count = ceil($products_count/$page_offset);    }    // echo $page_count;    $div_class = 1;    $rows_count = 0;    while($product_row = mysqli_fetch_assoc($result_products)) {      if($rows_count == $page_offset) {        $rows_count = 0;        $div_class++;       }      if($div_class == 1) $tr_visibility = "";       else $tr_visibility = ' style="display:none;"';      $product_id = $product_row['product_id'];      $pd_name = stripslashes($product_row['pd_name']);      $gallery_img = get_product_default_image($product_id);      if(empty($gallery_img)) $gallery_img = "no_image.jpg";      $gallery_img_exploded = explode(".", $gallery_img);      $gallery_img_name = $gallery_img_exploded[0];      $gallery_img_exstension = $gallery_img_exploded[1];      $gallery_img_thumb = "/site/images/products/".$gallery_img_name."_home_default.".$gallery_img_exstension;      @$thumb_image_params = getimagesize($_SERVER['DOCUMENT_ROOT'].$gallery_img_thumb);      $thumb_image_dimensions = $thumb_image_params[3];      $product_sort_order = $product_row['product_sort_order'];      $product_is_active = $product_row['product_is_active'];      $set_product = ($product_is_active == 1) ? 0 : 1;      $edit_link = "/_admin/catalog/products-details.php?category_ids_list=$category_ids_list&category_id=$current_category_id&product_id=$product_id";      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>    <table class="row_over<?=" row_$div_class";?>" <?=$tr_visibility;?>>      <tbody>        <tr id="tr_<?=$product_id;?>" class="<?=$class?>">          <td width="15%" class="text_left">            <a href="<?=$edit_link;?>" class="red_link">              <?=$pd_name;?>            </a>          </td>          <td width="16%">            <img src="<?=$gallery_img_thumb;?>" alt="<?=$pd_name;?>" />          </td>          <td width="10%">            <a href="javascript:;" onclick="SetProductActiveInactive(this,'<?=$product_id;?>', '<?=$set_product;?>')">              <?php if($product_is_active == 1) { ?>                <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate'];?>" title="<?=$languages[$current_lang]['title_deactivate'];?>" width="16" height="16" />              <?php } else { ?>                <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate'];?>" title="<?=$languages[$current_lang]['title_activate'];?>" width="16" height="16" />              <?php } ?>            </a>          </td>          <td width="11%" class="hidden">            <?php              // if($product_count > 1) we gonna give the appropriate moving options              // else we gonna leave this empty              if($products_count > 1) {                if($key == 0) {            ?>                <a href="javascript:;" onclick="MoveProductForwardBackward('<?=$product_id;?>','<?=$current_category_id;?>','<?=$product_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>              <?php } elseif($key == $products_count-1) { ?>                <a href="javascript:;" onclick="MoveProductForwardBackward('<?=$product_id;?>','<?=$current_category_id;?>','<?=$product_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>              <?php } else { ?>                <a href="javascript:;" onclick="MoveProductForwardBackward('<?=$product_id;?>','<?=$current_category_id;?>','<?=$product_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>                <a href="javascript:;" onclick="MoveProductForwardBackward('<?=$product_id;?>','<?=$current_category_id;?>','<?=$product_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>            <?php                 }              } // if($product_count > 1)            ?>          </td>          <td width="6%">            <a href="<?=$edit_link;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="6%">            <a href="javascript:;" class="delete_product_link" data-id="<?=$product_id;?>">              <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />            </a>          </td>        </tr>      </tbody>    </table><?php      $key++;      $rows_count++;    } // while($product_row)    mysqli_free_result($result_products);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_product_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteProduct();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_product_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_product_link").click(function() {    $(".delete_product_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php      if(isset($page_count)) {?>      <ul class="js_pagination pagination"><?php      $current_page = 1;      while($current_page <= $page_count) {        if($current_page == 1) {          $li_current = ' class="active"';           echo '<li class="disabled btn_prev_page"><a href="javascript:;">&laquo; </a></li>';        }        else {          $li_current = "";        }        echo "<li id='pag_$current_page' $li_current><a href='javascript:;' data=\"$current_page\">$current_page</a></li>";        $current_page++;      }?>        <li class="btn_next_page"><a href="javascript:;" data="2"> &raquo;</a></li>      </ul>      <input type="hidden" class="page_count" value="<?=$page_count;?>" ><?php      }    } // if($products_count > 0)    else {      echo "<tr class='even'><td width='20%' class='text_left'>".$languages[$current_lang]['no_products_in_the_database_yet']."</td><td colspan='6'>&nbsp;</td></tr>";    }}function list_languages() {    global $db_link;  global $languages;  global $current_lang;  global $users_rights_edit;  global $users_rights_delete;  $query_languages = "SELECT `language_id`, `language_code`, `language_name`, `language_menu_order`,                             `language_is_default_frontend`,`language_is_default_backend`, `language_is_active`                       FROM `languages`                      ORDER BY `language_menu_order` ASC";  //echo $query_content;exit;  $result_languages = mysqli_query($db_link, $query_languages);  if(!$result_languages) echo mysqli_error($db_link);  $language_count = mysqli_num_rows($result_languages);  if($language_count > 0) {    $key = 0;    $class = ($key == 0) ? "even" : "$class";    while($language_row = mysqli_fetch_assoc($result_languages)) {      $language_id = $language_row['language_id'];      $language_code = $language_row['language_code'];      $language_name = $language_row['language_name'];      $language_menu_order = $language_row['language_menu_order'];      $language_is_default_frontend = $language_row['language_is_default_frontend'];      $language_is_default_backend = $language_row['language_is_default_backend'];      $language_is_active = $language_row['language_is_active'];      $set_language = ($language_is_active == 1) ? 0 : 1;      $class = (($class == "odd") ? "even" : "odd");?>      <table class="row_over">        <tbody>          <tr id="tr_<?=$language_id;?>" class="<?=$class?>">            <td width="20%" class="text_left">              <a href="/_admin/language/languages.php?language_id=<?=$language_id;?>" class="red_link"><?=$language_code;?></a>            </td>            <td width="20%" class="text_left"><?=$language_name;?></td>            <td width="5%">              <a href="javascript:;" onclick="SetLanguageActiveInactive(this,'<?=$language_id;?>', '<?=$set_language;?>')">                <?php if($language_is_active == 1) { ?>                  <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate_language'];?>" title="<?=$languages[$current_lang]['title_deactivate_language'];?>" width="16" height="16" />                <?php } else { ?>                  <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate_language'];?>" title="<?=$languages[$current_lang]['title_activate_language'];?>" width="16" height="16" />                <?php } ?>              </a>            </td>            <td width="15%">              <?php if($language_is_default_frontend == 1) { ?>                <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_language_is_default_frontend'];?>" title="<?=$languages[$current_lang]['title_language_is_default_frontend'];?>" width="16" height="16" />              <?php } else { ?>              <a href="javascript:;" onclick="if(confirm('<?php echo $languages[$current_lang]['set_language_default_warning_1']." $language_name ".$languages[$current_lang]['set_language_default_warning_2'];?>')) SetLanguageDefault('<?=$language_id;?>','_frontend');">                <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_set_language_default'];?>" title="<?=$languages[$current_lang]['title_set_language_default'];?>" width="16" height="16" />              </a>              <?php } ?>            </td>            <td width="15%">              <?php if($language_is_default_backend == 1) { ?>                <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_language_is_default_backend'];?>" title="<?=$languages[$current_lang]['title_language_is_default_backend'];?>" width="16" height="16" />              <?php } else { ?>              <a href="javascript:;" onclick="if(confirm('<?php echo $languages[$current_lang]['set_language_default_warning_1']." $language_name ".$languages[$current_lang]['set_language_default_warning_2'];?>')) SetLanguageDefault('<?=$language_id;?>','_backend');">                <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_set_language_default'];?>" title="<?=$languages[$current_lang]['title_set_language_default'];?>" width="16" height="16" />              </a>              <?php } ?>            </td>            <td width="10%">              <?php                // if($language_count > 1) we gonna give the appropriate moving options                // else we gonna leave this empty                if($language_count > 1) {                  if($key == 0) {              ?>                  <a href="javascript:;" onclick="MoveLanguageForwardBackward('<?=$language_id;?>','<?=$language_menu_order;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_language_backward'];?>" title="<?=$languages[$current_lang]['title_move_language_backward'];?>" width="16" height="16" />                  </a>                <?php } elseif($key == $language_count-1) { ?>                  <a href="javascript:;" onclick="MoveLanguageForwardBackward('<?=$language_id;?>','<?=$language_menu_order;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_language_forward'];?>" title="<?=$languages[$current_lang]['title_move_language_forward'];?>" width="16" height="16" />                  </a>                <?php } else { ?>                  <a href="javascript:;" onclick="MoveLanguageForwardBackward('<?=$language_id;?>','<?=$language_menu_order;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_language_backward'];?>" title="<?=$languages[$current_lang]['title_move_language_backward'];?>" width="16" height="16" />                  </a>                  <a href="javascript:;" onclick="MoveLanguageForwardBackward('<?=$language_id;?>','<?=$language_menu_order;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_language_forward'];?>" title="<?=$languages[$current_lang]['title_move_language_forward'];?>" width="16" height="16" />                  </a>              <?php                   }                } // if($language_count > 1)              ?>            </td>            <td width="5%">              <a href="/_admin/language/languages.php?language_id=<?=$language_id;?>">                <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit_language'];?>" title="<?=$languages[$current_lang]['title_edit_language'];?>" width="16" height="16" />              </a>            </td>            <td width="5%">              <a href="javascript:;" class="delete_language_link" data-id="<?=$language_id;?>">                <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete_language'];?>" title="<?=$languages[$current_lang]['title_delete_language'];?>" width="16" height="16" />              </a>            </td>          </tr>        </tbody>      </table><?php      $key++;    }    mysqli_free_result($result_languages);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_language_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteLanguage('first');      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_language_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_language_link").click(function() {<?php if($users_rights_delete == 1) { ?>    $(".delete_language_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");<?php } else { ?>    alert('<?=$languages[$current_lang]['no_rights_for_delete'];?>');<?php } ?>  });});</script><?php  }  else echo "<tr class='even'><td width='20%' class='text_left'>".$languages[$current_lang]['no_languages_in_database_yet']."</td><td colspan='6'>&nbsp;</td></tr>";}function list_clients() {    global $db_link;  global $current_language_id;  global $languages;  global $current_lang;  global $class;    $query_clients = "SELECT `clients`.`client_id`,`clients`.`client_image`,`clients`.`client_is_active`,`clients`.`client_sort_order`,                            `clients_descriptions`.`client_name`                    FROM `clients`                    INNER JOIN `clients_descriptions` ON `clients_descriptions`.`client_id` = `clients`.`client_id`                    WHERE `clients_descriptions`.`language_id` = '$current_language_id'                    ORDER BY `client_sort_order` ASC";  //echo $query_clients;exit;  $result_clients = mysqli_query($db_link, $query_clients);  if(!$result_clients) echo mysqli_error($db_link);  $clients_count = mysqli_num_rows($result_clients);  if($clients_count > 0) {    $key = 0;        while($client_row = mysqli_fetch_assoc($result_clients)) {      $client_id = $client_row['client_id'];      $client_name = stripslashes($client_row['client_name']);      $client_is_active = $client_row['client_is_active'];      $client_sort_order = $client_row['client_sort_order'];      $set_clients = ($client_is_active == 1) ? 0 : 1;      $client_image = $client_row['client_image'];      if(!empty($client_image)) {        $client_image_exploded = explode(".", $client_image);        $client_image_name = $client_image_exploded[0];        $client_image_exstension = $client_image_exploded[1];        $client_image_thumb = "/site/images/clients/".$client_image_name."_admin_thumb.".$client_image_exstension;        @$thumb_image_params = getimagesize($_SERVER['DOCUMENT_ROOT'].$client_image_thumb);        $thumb_image_dimensions = $thumb_image_params[3];      }      else {        $client_image_thumb = "/site/images/no_image.png";        @$thumb_image_params = getimagesize($_SERVER['DOCUMENT_ROOT'].$client_image_thumb);        $thumb_image_dimensions = $thumb_image_params[3];      }      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>    <table class="row_over">      <tbody>        <tr id="tr_<?=$client_id;?>" class="<?=$class?>">          <td width="2%" class="text_left"><?=$client_id;?></td>          <td width="43%" class="text_left">            <a href="/_admin/clients/clients.php?client_id=<?=$client_id;?>" class="red_link">              <img src="<?=$client_image_thumb;?>" alt="<?=$client_name;?>" <?=$thumb_image_dimensions;?>>            </a>          </td>          <td width="30%" class="text_left"><?=$client_name;?></td>          <td width="5%">            <a href="javascript:;" onclick="SetClientActiveInactive(this,'<?=$client_id;?>', '<?=$set_clients;?>')">              <?php if($client_is_active == 1) { ?>                <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate'];?>" title="<?=$languages[$current_lang]['title_deactivate'];?>" width="16" height="16" />              <?php } else { ?>                <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate'];?>" title="<?=$languages[$current_lang]['title_activate'];?>" width="16" height="16" />              <?php } ?>            </a>          </td>          <td width="10%">            <?php              // if($clients_count > 1) we gonna give the appropriate moving options              // else we gonna leave this empty              if($clients_count > 1) {                if($key == 0) {            ?>                <a href="javascript:;" onclick="MoveClientForwardBackward('<?=$client_id;?>','<?=$client_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>              <?php } elseif($key == $clients_count-1) { ?>                <a href="javascript:;" onclick="MoveClientForwardBackward('<?=$client_id;?>','<?=$client_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>              <?php } else { ?>                <a href="javascript:;" onclick="MoveClientForwardBackward('<?=$client_id;?>','<?=$client_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>                <a href="javascript:;" onclick="MoveClientForwardBackward('<?=$client_id;?>','<?=$client_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>            <?php                 }              } // if($count_options > 1)            ?>          </td>          <td width="5%">            <a href="/_admin/clients/clients.php?client_id=<?=$client_id;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="5%">            <a href="javascript:;" class="delete_client_link" data-id="<?=$client_id;?>">              <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />            </a>          </td>        </tr>      </tbody>    </table><?php      $key++;    }    mysqli_free_result($result_clients);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_client_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteClient();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_client_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_client_link").click(function() {    $(".delete_client_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_instructors() {    global $db_link;  global $languages;  global $current_lang;  global $users_rights_edit;  global $users_rights_delete;  $query_instructors = "SELECT `instructors`.* FROM `instructors` ORDER BY `instructor_sort_order` ASC";  //echo $query_instructors;exit;  $result_instructors = mysqli_query($db_link, $query_instructors);  if(!$result_instructors) echo mysqli_error($db_link);  $instructors_count = mysqli_num_rows($result_instructors);  if($instructors_count > 0) {    $key = 0;    while($instructors_row = mysqli_fetch_assoc($result_instructors)) {      $instructor_id = $instructors_row['instructor_id'];      $instructor_name = $instructors_row['instructor_name'];      $instructor_position = $instructors_row['instructor_position'];      $instructor_certificates = $instructors_row['instructor_certificates'];      $instructor_experience = $instructors_row['instructor_experience'];      $instructor_facebook = $instructors_row['instructor_facebook'];      $instructor_image = "/site/images/instructors/".$instructors_row['instructor_image'];      @$instructor_image_params = getimagesize($_SERVER['DOCUMENT_ROOT'].$instructor_image);      $instructor_image_dimensions = @$instructor_image_params[3];      $instructor_sort_order = $instructors_row['instructor_sort_order'];      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>      <table class="row_over">        <tbody>          <tr id="tr_<?=$instructor_id;?>" class="<?=$class?>">            <td width="30%" class="text_left">              <a href="/_admin/instructors/instructors.php?instructor_id=<?=$instructor_id;?>" class="red_link"><?=$instructor_name;?></a>            </td>            <td width="30%" class="text_left"><img src="<?=$instructor_image;?>" alt="<?=$instructor_name;?>" height="160"></td>            <td width="10%">              <?php                // if($instructors_count > 1) we gonna give the appropriate moving options                // else we gonna leave this empty                if($instructors_count > 1) {                  if($key == 0) {              ?>                  <a href="javascript:;" onclick="MoveInstructorForwardBackward('<?=$instructor_id;?>','<?=$instructor_sort_order;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                  </a>                <?php } elseif($key == $instructors_count-1) { ?>                  <a href="javascript:;" onclick="MoveInstructorForwardBackward('<?=$instructor_id;?>','<?=$instructor_sort_order;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                  </a>                <?php } else { ?>                  <a href="javascript:;" onclick="MoveInstructorForwardBackward('<?=$instructor_id;?>','<?=$instructor_sort_order;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                  </a>                  <a href="javascript:;" onclick="MoveInstructorForwardBackward('<?=$instructor_id;?>','<?=$instructor_sort_order;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                  </a>              <?php                   }                } // if($instructors_count > 1)              ?>            </td>            <td width="5%">              <a href="/_admin/instructors/instructors.php?instructor_id=<?=$instructor_id;?>">                <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />              </a>            </td>            <td width="5%">              <a href="javascript:;" class="delete_instructor_link" data-id="<?=$instructor_id;?>">                <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />              </a>            </td>          </tr>        </tbody>      </table><?php      $key++;    }    mysqli_free_result($result_instructors);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_instructor_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteLanguage('first');      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_instructor_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_instructor_link").click(function() {<?php if($users_rights_delete == 1) { ?>    $(".delete_instructor_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");<?php } else { ?>    alert('<?=$languages[$current_lang]['no_rights_for_delete'];?>');<?php } ?>  });});</script><?php  }  else echo "<tr class='even'><td width='20%' class='text_left'>".$languages[$current_lang]['no_languages_in_database_yet']."</td><td colspan='6'>&nbsp;</td></tr>";}function list_attributes_groups() {    global $db_link;  global $languages;  global $current_lang;    $query_attribute_groups = "SELECT `attribute_group_description`.`ag_description`,`attribute_group_description`.`attribute_group_id`,                                    `attribute_group`.`ag_sort_order`                            FROM `attribute_group_description`                             INNER JOIN `attribute_group` USING(`attribute_group_id`)                            INNER JOIN `languages` USING(`language_id`)                            WHERE `languages`.`language_is_default_backend` = '1'                             ORDER BY `attribute_group`.`ag_sort_order` ASC";  //echo $query_attribute_groups."<br>";  $result_attribute_groups = mysqli_query($db_link, $query_attribute_groups);  if(!$result_attribute_groups) echo mysqli_error($db_link);  $count_attribute_groups = mysqli_num_rows($result_attribute_groups);  if($count_attribute_groups > 0) {    $key = 0;    $class = ($key == 0) ? "even" : "$class";        while ($row = mysqli_fetch_assoc($result_attribute_groups)) {      $attribute_group_id = $row['attribute_group_id'];      $ag_sort_order = $row['ag_sort_order'];      $ag_description = stripslashes($row['ag_description']);      $class = (($class == "odd") ? "even" : "odd");?>      <table class="row_over">        <tbody>          <tr id="tr_<?=$attribute_group_id;?>" class="<?=$class?>">            <td width="60%" class="text_left">              <a href="/_admin/catalog/products-attributes-group-details.php?attribute_group_id=<?=$attribute_group_id;?>" class="red_link"><?=$ag_description;?></a>            </td>            <td width="20%">              <?php                // if($count_attribute_groups > 1) we gonna give the appropriate moving options                // else we gonna leave this empty                if($count_attribute_groups > 1) {                  if($key == 0) {              ?>                  <a href="javascript:;" onclick="MoveAttributeGroupForwardBackward('<?=$attribute_group_id;?>','<?=$ag_sort_order;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_attribute_group_backward'];?>" title="<?=$languages[$current_lang]['title_move_attribute_group_backward'];?>" width="16" height="16" />                  </a>                <?php } elseif($key == $count_attribute_groups-1) { ?>                  <a href="javascript:;" onclick="MoveAttributeGroupForwardBackward('<?=$attribute_group_id;?>','<?=$ag_sort_order;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_attribute_group_forward'];?>" title="<?=$languages[$current_lang]['title_move_attribute_group_forward'];?>" width="16" height="16" />                  </a>                <?php } else { ?>                  <a href="javascript:;" onclick="MoveAttributeGroupForwardBackward('<?=$attribute_group_id;?>','<?=$ag_sort_order;?>','backward')">                    <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_attribute_group_backward'];?>" title="<?=$languages[$current_lang]['title_move_attribute_group_backward'];?>" width="16" height="16" />                  </a>                  <a href="javascript:;" onclick="MoveAttributeGroupForwardBackward('<?=$attribute_group_id;?>','<?=$ag_sort_order;?>','forward')">                    <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_attribute_group_forward'];?>" title="<?=$languages[$current_lang]['title_move_attribute_group_forward'];?>" width="16" height="16" />                  </a>              <?php                   }                } // if($count_attribute_groups > 1)              ?>            </td>            <td width="10%">              <a href="/_admin/catalog/products-attributes-group-details.php?attribute_group_id=<?=$attribute_group_id;?>">                <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit_attribute_group'];?>" title="<?=$languages[$current_lang]['title_edit_attribute_group'];?>" width="16" height="16" />              </a>            </td>            <td width="10%">              <a href="javascript:;" class="delete_attribute_group_link" data-id="<?=$attribute_group_id;?>">                <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete_attribute_group'];?>" title="<?=$languages[$current_lang]['title_delete_attribute_group'];?>" width="16" height="16" />              </a>            </td>          </tr>        </tbody>      </table><?php      $key++;    }    mysqli_free_result($result_attribute_groups);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_attribute_group_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteAttributeGroup();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_attribute_group_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_attribute_group_link").click(function() {    $(".delete_attribute_group_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_attributes_groups_for_choose_group($current_attribute_group_id) {    global $db_link;  global $languages;  global $current_lang;    $query_attribute_groups = "SELECT `attribute_group_description`.`ag_description`,`attribute_group_description`.`attribute_group_id`,                                    `attribute_group`.`ag_sort_order`                            FROM `attribute_group_description`                             INNER JOIN `attribute_group` USING(`attribute_group_id`)                            INNER JOIN `languages` USING(`language_id`)                            WHERE `languages`.`language_is_default_backend` = '1'                             ORDER BY `attribute_group`.`ag_sort_order` ASC";  //echo $query_attribute_groups."<br>";  $result_attribute_groups = mysqli_query($db_link, $query_attribute_groups);  if(!$result_attribute_groups) echo mysqli_error($db_link);  $count_attribute_groups = mysqli_num_rows($result_attribute_groups);  if($count_attribute_groups > 0) {        while ($row = mysqli_fetch_assoc($result_attribute_groups)) {      $attribute_group_id = $row['attribute_group_id'];      $ag_description = stripslashes($row['ag_description']);      $class_active = (($current_attribute_group_id == $attribute_group_id) ? " active" : "");?>      <tr>        <td class="text_left<?=$class_active;?>">          <a href="javascript:;" onClick="GetAttributesByGroup(this)" data-id="<?=$attribute_group_id;?>" class="red_link"><?=$ag_description;?></a>        </td>      </tr><?php    }        mysqli_free_result($result_attribute_groups);  }}function list_attributes_groups_for_select($current_attribute_group_id) {    global $db_link;  $query_attribute_groups = "SELECT `attribute_group_description`.`ag_description`,`attribute_group_description`.`attribute_group_id`,                                    `attribute_group`.`ag_sort_order`                            FROM `attribute_group_description`                             INNER JOIN `attribute_group` USING(`attribute_group_id`)                            INNER JOIN `languages` USING(`language_id`)                            WHERE `languages`.`language_is_default_backend` = '1'                             ORDER BY `attribute_group`.`ag_sort_order` ASC";  //echo $query_attribute_groups."<br>";  $result_attribute_groups = mysqli_query($db_link, $query_attribute_groups);  if(!$result_attribute_groups) echo mysqli_error($db_link);  $count_attribute_groups = mysqli_num_rows($result_attribute_groups);  if($count_attribute_groups > 0) {    while ($row = mysqli_fetch_assoc($result_attribute_groups)) {      $attribute_group_id = $row['attribute_group_id'];      $ag_description = stripslashes($row['ag_description']);      if ($current_attribute_group_id == $attribute_group_id)          $selected = 'selected="selected"';      else          $selected = "";            echo "<option value='$attribute_group_id' $selected>$ag_description</option>";            }    mysqli_free_result($result_attribute_groups);  }}function list_attributes_by_attribute_group($attribute_group_id) {    global $db_link;  global $languages;  global $current_lang;    $query_attributes = "SELECT `attributes`.`attribute_id`, `attributes`.`attribute_sort_order`,`attribute_description`.`attribute_description`                      FROM `attributes`                       INNER JOIN `attribute_description` USING(`attribute_id`)                      INNER JOIN `languages` USING(`language_id`)                      WHERE `attributes`.`attribute_group_id` = '$attribute_group_id' AND `languages`.`language_is_default_backend` = '1'                       ORDER BY `attributes`.`attribute_sort_order` ASC";  //echo $query_attributes."<br>";  $result_attributes = mysqli_query($db_link, $query_attributes);  if(!$result_attributes) echo mysqli_error($db_link);  $count_attributes = mysqli_num_rows($result_attributes);  if($count_attributes > 0) {    $key = 0;        while ($row = mysqli_fetch_assoc($result_attributes)) {      $attribute_id = $row['attribute_id'];      $attribute_sort_order = $row['attribute_sort_order'];      $attribute_description = stripslashes($row['attribute_description']);      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>    <table class="row_over">      <tbody>        <tr id="tr_<?=$attribute_id;?>" class="<?=$class?>">          <td width="60%" class="text_left">            <a href="/_admin/catalog/products-attributes-attribute-details.php?attribute_id=<?=$attribute_id;?>&attribute_group_id=<?=$attribute_group_id;?>" class="red_link"><?=$attribute_description;?></a>          </td>          <td width="20%">            <?php              // if($count_attributes > 1) we gonna give the appropriate moving options              // else we gonna leave this empty              if($count_attributes > 1) {                if($key == 0) {            ?>                <a href="javascript:;" onclick="MoveAttributeForwardBackward('<?=$attribute_id;?>','<?=$attribute_group_id;?>','<?=$attribute_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>              <?php } elseif($key == $count_attributes-1) { ?>                <a href="javascript:;" onclick="MoveAttributeForwardBackward('<?=$attribute_id;?>','<?=$attribute_group_id;?>','<?=$attribute_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>              <?php } else { ?>                <a href="javascript:;" onclick="MoveAttributeForwardBackward('<?=$attribute_id;?>','<?=$attribute_group_id;?>','<?=$attribute_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>                <a href="javascript:;" onclick="MoveAttributeForwardBackward('<?=$attribute_id;?>','<?=$attribute_group_id;?>','<?=$attribute_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>            <?php                 }              } // if($count_attributes > 1)            ?>          </td>          <td width="10%">            <a href="/_admin/catalog/products-attributes-attribute-details.php?attribute_id=<?=$attribute_id;?>&attribute_group_id=<?=$attribute_group_id;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="10%">            <a href="javascript:;" class="delete_attribute_link" data-id="<?=$attribute_id;?>" data-parent="<?=$attribute_group_id;?>">              <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />            </a>          </td>        </tr>      </tbody>    </table><?php      $key++;    }    mysqli_free_result($result_attributes);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_attribute_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteAttribute('first');      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_attribute_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_attribute_link").click(function() {    $(".delete_attribute_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }  else {?>      <tr>        <td width="60%" class="text_left"><?=$languages[$current_lang]['text_no_attributes_for_this_group_yet'];?></td>        <td></td>      </tr><?php  }}function list_news_categories($news_cat_parent_id, $path_number) {    global $db_link;  global $languages;  global $current_language_id;  global $current_lang;  global $class;  $query_news_categories = "SELECT `news_categories`.`news_category_id`,`news_categories`.`news_cat_parent_id`,`news_categories`.`news_cat_hierarchy_level`,                                  `news_categories`.`news_cat_has_children`,`news_categories`.`news_cat_sort_order`,`news_categories`.`news_cat_is_collapsed`,                                  `news_cat_desc`.`news_cat_name`,`news_cat_desc`.`news_cat_long_name`                             FROM `news_categories`                             INNER JOIN `news_cat_desc` USING(`news_category_id`)                            WHERE `news_categories`.`news_cat_parent_id` = '$news_cat_parent_id' AND `news_cat_desc`.`language_id` = '$current_language_id'                            ORDER BY `news_categories`.`news_cat_sort_order` ASC";  //echo "<pre>$query_news_categories</pre>";exit;  $result_news_categories = mysqli_query($db_link, $query_news_categories);  if(!$result_news_categories) echo mysqli_error($db_link);  $news_count = mysqli_num_rows($result_news_categories);  if($news_count > 0) {    $key = 0;    while($news_categories_row = mysqli_fetch_assoc($result_news_categories)) {      $news_category_id = $news_categories_row['news_category_id'];      $news_cat_parent_id = $news_categories_row['news_cat_parent_id'];      $news_cat_name = $news_categories_row['news_cat_name'];      $news_cat_hierarchy_level = $news_categories_row['news_cat_hierarchy_level'];      $news_cat_has_children = $news_categories_row['news_cat_has_children'];      $news_cat_sort_order = $news_categories_row['news_cat_sort_order'];      $news_cat_is_collapsed = $news_categories_row['news_cat_is_collapsed'];      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");      $name_dashes = "";      if($news_cat_hierarchy_level == 1) {          $path_number++;          $news_cat_path_number = $path_number;      } else {          $news_cat_path_number = "$path_number.$news_cat_sort_order";          if($news_cat_hierarchy_level == 2) $name_dashes = "- ";          if($news_cat_hierarchy_level == 3) $name_dashes = "- - ";          if($news_cat_hierarchy_level == 4) $name_dashes = "- - - ";          if($news_cat_hierarchy_level == 5) $name_dashes = "- - - - ";      }?>    <table class="row_over">      <tbody>        <tr id="tr_<?=$news_category_id;?>" class="<?=$class?>">          <td width="3%" class="text_left">            <a href="javascript:;" onclick="ToggleExpandNewsCategory('<?=$news_category_id;?>', '<?php if($news_cat_is_collapsed == 1) echo "expand"; else echo "collapse" ?>');">              <?php                 if($news_cat_has_children == 0) {                  // no children, print nothing                } else {                    if($news_cat_is_collapsed == 0) { ?>                    <img src="/_admin/images/contract.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_collapse_section'];?>" title="<?=$languages[$current_lang]['title_collapse_section'];?>" width="16" height="16" />                  <?php } else { ?>                    <img src="/_admin/images/expand.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_open_section'];?>" title="<?=$languages[$current_lang]['title_open_section'];?>" width="16" height="16" />                  <?php                   }                 }              ?>            </a>          </td>          <td width="7%" class="text_left"><?=$news_cat_path_number;?></td>          <td width="60%" class="text_left">            <a href="/_admin/news/news-categories.php?news_category_id=<?=$news_category_id;?>" class="red_link"><?="$name_dashes$news_cat_name";?></a>          </td>          <td width="15%">            <?php              // if($news_count > 1) we gonna give the appropriate moveing options              // else we gonna leave this empty              if($news_count > 1) {                if($key == 0) {            ?>                <a href="javascript:;" onclick="MoveNewsCategoryForwardBackward('<?=$news_category_id;?>','<?=$news_cat_parent_id;?>','<?=$news_cat_sort_order;?>','<?=$news_cat_hierarchy_level;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>              <?php } elseif($key == $news_count-1) { ?>                <a href="javascript:;" onclick="MoveNewsCategoryForwardBackward('<?=$news_category_id;?>','<?=$news_cat_parent_id;?>','<?=$news_cat_sort_order;?>','<?=$news_cat_hierarchy_level;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>              <?php } else { ?>                <a href="javascript:;" onclick="MoveNewsCategoryForwardBackward('<?=$news_category_id;?>','<?=$news_cat_parent_id;?>','<?=$news_cat_sort_order;?>','<?=$news_cat_hierarchy_level;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>                <a href="javascript:;" onclick="MoveNewsCategoryForwardBackward('<?=$news_category_id;?>','<?=$news_cat_parent_id;?>','<?=$news_cat_sort_order;?>','<?=$news_cat_hierarchy_level;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>            <?php                 }              } // if($news_count > 1)            ?>          </td>          <td width="7.5%">            <a href="/_admin/news/news-categories.php?news_category_id=<?=$news_category_id;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="7.5%">            <?php if($news_cat_has_children == 0) { ?>              <a href="javascript:;" class="delete_news_category_link" data-id="<?=$news_category_id;?>" data-parent-id="<?=$news_cat_parent_id;?>">                <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />              </a>            <?php } ?>          </td>        </tr>      </tbody>    </table><?php      if($news_cat_is_collapsed == 0 && $news_cat_has_children == 1) {        list_news_categories($news_category_id, $news_cat_path_number);      }      $key++;    }    mysqli_free_result($result_news_categories);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_news_category_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteNewsCategory();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_news_category_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_news_category_link").click(function() {    $(".delete_news_category_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_news() {    global $db_link;  global $current_language_id;  global $languages;  global $current_lang;  global $class;  $query_content = "SELECT `content_hierarchy_path` FROM `contents`                    WHERE `content_type_id` = '7'                       AND `content_hierarchy_ids` LIKE CONCAT('%', (SELECT `language_root_content_id` FROM `languages` WHERE `language_id` = '$current_language_id'), '%')";  //echo $query_content;exit;  $result_content = mysqli_query($db_link, $query_content);  if(!$result_content) echo mysqli_error($db_link);  if(mysqli_num_rows($result_content) > 0) {    $row = mysqli_fetch_assoc($result_content);    $content_hierarchy_path = $row['content_hierarchy_path'];  }    $query_news = "SELECT `news`.`news_id`,`news`.`news_post_date`,`news`.`news_start_time`,`news`.`news_end_time`,                        `news`.`news_is_active`,`news_descriptions`.`news_title`,`news_cat_desc`.`news_cat_long_name`                     FROM `news`                     INNER JOIN `news_descriptions` ON `news_descriptions`.`news_id` = `news`.`news_id`                    INNER JOIN `news_cat_desc` ON `news_cat_desc`.`news_category_id` = `news`.`news_category_id`                    WHERE `news_descriptions`.`language_id` = '$current_language_id' AND `news_cat_desc`.`language_id` = '$current_language_id'                    ORDER BY `news`.`news_created_date` DESC";  //echo "<pre>$query_news</pre>";exit;  $result_news = mysqli_query($db_link, $query_news);  if(!$result_news) echo mysqli_error($db_link);  $news_count = mysqli_num_rows($result_news);  if($news_count > 0) {    while($news_row = mysqli_fetch_assoc($result_news)) {      $news_id = $news_row['news_id'];      $news_title = $news_row['news_title'];      $news_cat_long_name = $news_row['news_cat_long_name'];      $news_post_date = date("d.m.Y H:i:s", strtotime($news_row['news_post_date']));      $news_start_time = (!is_null($news_row['news_start_time'])) ? date("d.m.Y H:i:s", strtotime($news_row['news_start_time'])) : "";      $news_end_time = (!is_null($news_row['news_end_time'])) ? date("d.m.Y H:i:s", strtotime($news_row['news_end_time'])) : "";      $news_is_active = $news_row['news_is_active'];      $set_news = ($news_is_active == 1) ? 0 : 1;      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>    <table class="row_over">      <tbody>        <tr id="tr_<?=$news_id;?>" class="<?=$class?>">          <td width="2%" class="text_left"><?=$news_id;?></td>          <td width="33%" class="text_left">            <a href="/_admin/news/news.php?news_id=<?=$news_id;?>" class="red_link"><?=$news_title;?></a>          </td>          <td width="12%" class="text_left"><?=$news_post_date;?></td>          <td width="8%" class="text_left"><?=$news_start_time;?></td>          <td width="8%" class="text_left"><?=$news_end_time;?></td>          <td width="20%"><?=$news_cat_long_name;?></td>          <td width="5%">            <a href="javascript:;" onclick="SetNewsActiveInactive(this,'<?=$news_id;?>', '<?=$set_news;?>')">              <?php if($news_is_active == 1) { ?>                <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate'];?>" title="<?=$languages[$current_lang]['title_deactivate'];?>" width="16" height="16" />              <?php } else { ?>                <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate'];?>" title="<?=$languages[$current_lang]['title_activate'];?>" width="16" height="16" />              <?php } ?>            </a>          </td>          <td width="3%">            <a href="<?="/$content_hierarchy_path/$news_title?nid=$news_id";?>" target="_blank">              <img src="/_admin/images/view.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_view'];?>" title="<?=$languages[$current_lang]['title_view'];?>" width="16" height="16" />            </a>          </td>          <td width="3%">            <a href="/_admin/news/news.php?news_id=<?=$news_id;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="3%">            <a href="javascript:;" class="delete_news_link" data-id="<?=$news_id;?>">              <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />            </a>          </td>          <td width="4%">            <input type="checkbox" class="multicontent" value="<?=$news_id;?>" name="multicontent[]" title="<?=$languages[$current_lang]['title_toggle_checkbox'];?>"/>          </td>        </tr>      </tbody>    </table><?php    }    mysqli_free_result($result_news);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_news_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteNews();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_news_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_news_link").click(function() {    $(".delete_news_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_events() {    global $db_link;  global $current_language_id;  global $languages;  global $current_lang;  global $class;    $content_type_id = 2; // events  $query_content = "SELECT `content_pretty_url`                    FROM `contents`                    WHERE `content_type_id` = '$content_type_id' AND `content_parent_id` =  (SELECT `language_root_content_id` FROM `languages` WHERE `language_code` = '$current_lang')";  //echo $query_content."<br><br>";  $result_content = mysqli_query($db_link, $query_content);  if(!$result_content) echo mysqli_error($db_link);  if(mysqli_num_rows($result_content) > 0) {    $content_array = mysqli_fetch_assoc($result_content);    $content_pretty_url = $content_array['content_pretty_url'];  }    $query_event = "SELECT `events`.`event_id`,`events`.`event_date`,`events`.`event_time_start`,`events`.`event_time_end`,                          `events`.`event_map_address`,`events`.`event_is_active`,`events_descriptions`.`event_name`                  FROM `events`                   INNER JOIN `events_descriptions` ON `events_descriptions`.`event_id` = `events`.`event_id`                  WHERE `events_descriptions`.`language_id` = '$current_language_id'                  ORDER BY `events`.`event_date` DESC";  //echo $query_event;exit;  $result_event = mysqli_query($db_link, $query_event);  if(!$result_event) echo mysqli_error($db_link);  $event_count = mysqli_num_rows($result_event);  if($event_count > 0) {    while($event_row = mysqli_fetch_assoc($result_event)) {      $event_id = $event_row['event_id'];      $event_name = $event_row['event_name'];      $event_date = date("d.m.Y", strtotime($event_row['event_date']));      $event_time_start = (!is_null($event_row['event_time_start'])) ? date("H:i", strtotime($event_row['event_time_start'])) : "";      $event_time_end = (!is_null($event_row['event_time_end'])) ? date("H:i", strtotime($event_row['event_time_end'])) : "";      $event_map_address = $event_row['event_map_address'];      $event_is_active = $event_row['event_is_active'];      $set_event = ($event_is_active == 1) ? 0 : 1;      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>    <table class="row_over">      <tbody>        <tr id="tr_<?=$event_id;?>" class="<?=$class?>">          <td width="2%" class="text_left"><?=$event_id;?></td>          <td width="33%" class="text_left">            <a href="/_admin/events/events.php?event_id=<?=$event_id;?>" class="red_link"><?=$event_name;?></a>          </td>          <td width="12%"><?=$event_date;?></td>          <td width="8%"><?=$event_time_start;?></td>          <td width="8%"><?=$event_time_end;?></td>          <td width="20%"><?=$event_map_address;?></td>          <td width="5%">            <a href="javascript:;" onclick="SetEventActiveInactive(this,'<?=$event_id;?>', '<?=$set_event;?>')">              <?php if($event_is_active == 1) { ?>                <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate'];?>" title="<?=$languages[$current_lang]['title_deactivate'];?>" width="16" height="16" />              <?php } else { ?>                <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate'];?>" title="<?=$languages[$current_lang]['title_activate'];?>" width="16" height="16" />              <?php } ?>            </a>          </td>          <td width="3%">            <a href="<?="/$current_lang/$content_pretty_url/$event_name?eid=$event_id";?>" target="_blank">              <img src="/_admin/images/view.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_view'];?>" title="<?=$languages[$current_lang]['title_view'];?>" width="16" height="16" />            </a>          </td>          <td width="3%">            <a href="/_admin/events/events.php?event_id=<?=$event_id;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="3%">            <a href="javascript:;" class="delete_event_link" data-id="<?=$event_id;?>">              <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />            </a>          </td>          <td width="4%">            <input type="checkbox" class="multicontent" value="<?=$event_id;?>" name="multicontent[]" title="<?=$languages[$current_lang]['title_toggle_checkbox'];?>"/>          </td>        </tr>      </tbody>    </table><?php    }    mysqli_free_result($result_event);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_event_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteEvent();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_event_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_event_link").click(function() {    $(".delete_event_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_courses() {    global $db_link;  global $current_language_id;  global $languages;  global $current_lang;  global $class;    $content_type_id = 9; // courses  $query_content = "SELECT `content_pretty_url`                    FROM `contents`                    WHERE `content_type_id` = '$content_type_id' AND `content_parent_id` =  (SELECT `language_root_content_id` FROM `languages` WHERE `language_code` = '$current_lang')";  //echo $query_content."<br><br>";  $result_content = mysqli_query($db_link, $query_content);  if(!$result_content) echo mysqli_error($db_link);  if(mysqli_num_rows($result_content) > 0) {    $content_array = mysqli_fetch_assoc($result_content);    $content_pretty_url = $content_array['content_pretty_url'];  }    $query_course = "SELECT `courses`.`course_id`,`courses`.`course_date`,`courses`.`course_cost`,`courses`.`course_duration`,                            `courses`.`course_is_active`,`courses_descriptions`.`cd_name`                    FROM `courses`                     INNER JOIN `courses_descriptions` ON `courses_descriptions`.`course_id` = `courses`.`course_id`                    WHERE `courses_descriptions`.`language_id` = '$current_language_id'                    ORDER BY `courses`.`course_date` DESC";  //echo $query_course;exit;  $result_course = mysqli_query($db_link, $query_course);  if(!$result_course) echo mysqli_error($db_link);  $course_count = mysqli_num_rows($result_course);  if($course_count > 0) {    while($course_row = mysqli_fetch_assoc($result_course)) {      $course_id = $course_row['course_id'];      $cd_name = $course_row['cd_name'];      $course_date = date("d.m.Y", strtotime($course_row['course_date']));      $course_cost = $course_row['course_cost'];      $course_duration = $course_row['course_duration'];      $course_is_active = $course_row['course_is_active'];      $set_course = ($course_is_active == 1) ? 0 : 1;      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>    <table class="row_over">      <tbody>        <tr id="tr_<?=$course_id;?>" class="<?=$class?>">          <td width="2%" class="text_left"><?=$course_id;?></td>          <td width="30%" class="text_left">            <a href="/_admin/courses/courses.php?course_id=<?=$course_id;?>" class="red_link"><?=$cd_name;?></a>          </td>          <td width="12%"><?=$course_date;?></td>          <td width="34%"><?=$course_duration;?></td>          <td width="5%"><?=$course_cost;?></td>          <td width="5%">            <a href="javascript:;" onclick="SetCourseActiveInactive(this,'<?=$course_id;?>', '<?=$set_course;?>')">              <?php if($course_is_active == 1) { ?>                <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate'];?>" title="<?=$languages[$current_lang]['title_deactivate'];?>" width="16" height="16" />              <?php } else { ?>                <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate'];?>" title="<?=$languages[$current_lang]['title_activate'];?>" width="16" height="16" />              <?php } ?>            </a>          </td>          <td width="3%">            <a href="<?="/$current_lang/$content_pretty_url/$cd_name?tid=$course_id";?>" target="_blank">              <img src="/_admin/images/view.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_view'];?>" title="<?=$languages[$current_lang]['title_view'];?>" width="16" height="16" />            </a>          </td>          <td width="3%">            <a href="/_admin/courses/courses.php?course_id=<?=$course_id;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="3%">            <a href="javascript:;" class="delete_course_link" data-id="<?=$course_id;?>">              <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />            </a>          </td>          <td width="5%">            <input type="checkbox" class="multicontent" value="<?=$course_id;?>" name="multicontent[]" title="<?=$languages[$current_lang]['title_toggle_checkbox'];?>"/>          </td>        </tr>      </tbody>    </table><?php    }    mysqli_free_result($result_course);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_course_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteEvent();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_course_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_course_link").click(function() {    $(".delete_course_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_sliders() {    global $db_link;  global $current_language_id;  global $languages;  global $current_lang;  global $class;    $query_sliders = "SELECT `sliders`.`slider_id`,`sliders`.`slider_image`,`sliders`.`slider_is_active`,`sliders`.`slider_sort_order`,                            `sliders_descriptions`.`slider_header`,`sliders_descriptions`.`slider_text`                    FROM `sliders`                    INNER JOIN `sliders_descriptions` ON `sliders_descriptions`.`slider_id` = `sliders`.`slider_id`                    WHERE `sliders_descriptions`.`language_id` = '$current_language_id'                    ORDER BY `slider_sort_order` ASC";  //echo $query_sliders;exit;  $result_sliders = mysqli_query($db_link, $query_sliders);  if(!$result_sliders) echo mysqli_error($db_link);  $sliders_count = mysqli_num_rows($result_sliders);  if($sliders_count > 0) {    $key = 0;        while($slider_row = mysqli_fetch_assoc($result_sliders)) {      $slider_id = $slider_row['slider_id'];      $slider_header = stripslashes($slider_row['slider_header']);      $slider_text = stripslashes($slider_row['slider_text']);      $slider_is_active = $slider_row['slider_is_active'];      $slider_sort_order = $slider_row['slider_sort_order'];      $set_sliders = ($slider_is_active == 1) ? 0 : 1;      $slider_image = $slider_row['slider_image'];      if(!empty($slider_image)) {        $slider_image_exploded = explode(".", $slider_image);        $slider_image_name = $slider_image_exploded[0];        $slider_image_exstension = $slider_image_exploded[1];        $slider_image_thumb = "/site/images/slider/".$slider_image_name."_admin_thumb.".$slider_image_exstension;        @$thumb_image_params = getimagesize($_SERVER['DOCUMENT_ROOT'].$slider_image_thumb);        $thumb_image_dimensions = $thumb_image_params[3];      }      else {        $slider_image_thumb = "/site/images/no_image.png";        @$thumb_image_params = getimagesize($_SERVER['DOCUMENT_ROOT'].$slider_image_thumb);        $thumb_image_dimensions = $thumb_image_params[3];      }      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>    <table class="row_over">      <tbody>        <tr id="tr_<?=$slider_id;?>" class="<?=$class?>">          <td width="2%" class="text_left"><?=$slider_id;?></td>          <td width="43%" class="text_left">            <a href="/_admin/slider/sliders.php?slider_id=<?=$slider_id;?>" class="red_link">              <img src="<?=$slider_image_thumb;?>" alt="<?=$slider_header;?>" <?=$thumb_image_dimensions;?>>            </a>          </td>          <td width="30%" class="text_left"><?=$slider_header;?></td>          <td width="5%">            <a href="javascript:;" onclick="SetSliderActiveInactive(this,'<?=$slider_id;?>', '<?=$set_sliders;?>')">              <?php if($slider_is_active == 1) { ?>                <img src="/_admin/images/true.gif" class="systemicon img_active" alt="<?=$languages[$current_lang]['alt_deactivate'];?>" title="<?=$languages[$current_lang]['title_deactivate'];?>" width="16" height="16" />              <?php } else { ?>                <img src="/_admin/images/false.gif" class="systemicon img_inactive" alt="<?=$languages[$current_lang]['alt_activate'];?>" title="<?=$languages[$current_lang]['title_activate'];?>" width="16" height="16" />              <?php } ?>            </a>          </td>          <td width="10%">            <?php              // if($sliders_count > 1) we gonna give the appropriate moving options              // else we gonna leave this empty              if($sliders_count > 1) {                if($key == 0) {            ?>                <a href="javascript:;" onclick="MoveSliderForwardBackward('<?=$slider_id;?>','<?=$slider_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>              <?php } elseif($key == $sliders_count-1) { ?>                <a href="javascript:;" onclick="MoveSliderForwardBackward('<?=$slider_id;?>','<?=$slider_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>              <?php } else { ?>                <a href="javascript:;" onclick="MoveSliderForwardBackward('<?=$slider_id;?>','<?=$slider_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>                <a href="javascript:;" onclick="MoveSliderForwardBackward('<?=$slider_id;?>','<?=$slider_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>            <?php                 }              } // if($count_options > 1)            ?>          </td>          <td width="5%">            <a href="/_admin/slider/sliders.php?slider_id=<?=$slider_id;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="5%">            <a href="javascript:;" class="delete_slider_link" data-id="<?=$slider_id;?>">              <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />            </a>          </td>        </tr>      </tbody>    </table><?php      $key++;    }    mysqli_free_result($result_sliders);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_slider_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteSlider();      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_slider_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_slider_link").click(function() {    $(".delete_slider_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }}function list_news_categories_for_select($current_news_category_id) {    global $db_link;  $query_news_cat = "SELECT `news_categories`.`news_category_id`,`news_categories`.`news_cat_hierarchy_ids`,`news_categories`.`news_cat_hierarchy_level`,                            `news_cat_desc`.`news_cat_name`,`news_cat_desc`.`news_cat_long_name`                     FROM `news_categories`                     INNER JOIN `news_cat_desc` USING(`news_category_id`)                    INNER JOIN `languages` USING(`language_id`)                    WHERE `languages`.`language_is_default_backend` = '1'";  //echo $query_news_cat."<br>";  $result_news_cat = mysqli_query($db_link, $query_news_cat);  if(!$result_news_cat) echo mysqli_error($db_link);  $count_news_cat = mysqli_num_rows($result_news_cat);  if($count_news_cat > 0) {    while ($row = mysqli_fetch_assoc($result_news_cat)) {      $news_category_id = $row['news_category_id'];      $news_cat_hierarchy_ids = $row['news_cat_hierarchy_ids'];      $news_cat_hierarchy_level = $row['news_cat_hierarchy_level'];      //$news_cat_name = stripslashes($row['news_cat_name']);      $news_cat_long_name = stripslashes($row['news_cat_long_name']);      $selected = ($current_news_category_id == $news_category_id) ? 'selected="selected"' : "";            echo "<option value='$news_category_id+$news_cat_hierarchy_ids+$news_cat_hierarchy_level' $selected>$news_cat_long_name</option>";            }    mysqli_free_result($result_news_cat);  }}function list_products_options() {    global $db_link;  global $languages;  global $current_lang;    $query_options = "SELECT `option_description`.`option_desc_name`,`options`.`option_id`,`options`.`option_type`,`options`.`option_sort_order`                    FROM `option_description`                     INNER JOIN `options` USING(`option_id`)                    INNER JOIN `languages` USING(`language_id`)                    WHERE `languages`.`language_is_default_backend` = '1'                     ORDER BY `options`.`option_sort_order` ASC";  //echo $query_options."<br>";  $result_options = mysqli_query($db_link, $query_options);  if(!$result_options) echo mysqli_error($db_link);  $count_options = mysqli_num_rows($result_options);  if($count_options > 0) {    $key = 0;        while ($row = mysqli_fetch_assoc($result_options)) {      $option_id = $row['option_id'];      $option_sort_order = $row['option_sort_order'];      $option_type = $row['option_type'];      $option_desc_name = stripslashes($row['option_desc_name']);      if(!isset($class)) $class = "even";      $class = (($class == "odd") ? "even" : "odd");?>    <table class="row_over">      <tbody>        <tr id="tr_<?=$option_id;?>" class="<?=$class?>">          <td width="50%" class="text_left">            <a href="/_admin/catalog/products-options-details.php?option_id=<?=$option_id;?>" class="red_link"><?=$option_desc_name;?></a>          </td>          <td width="15%"><?=$languages[$current_lang]['option_'.$option_type];?></td>          <td width="10%"><?=$option_sort_order;?></td>          <td width="10%">            <?php              // if($count_options > 1) we gonna give the appropriate moving options              // else we gonna leave this empty              if($count_options > 1) {                if($key == 0) {            ?>                <a href="javascript:;" onclick="MoveOptionForwardBackward('<?=$option_id;?>','<?=$option_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>              <?php } elseif($key == $count_options-1) { ?>                <a href="javascript:;" onclick="MoveOptionForwardBackward('<?=$option_id;?>','<?=$option_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>              <?php } else { ?>                <a href="javascript:;" onclick="MoveOptionForwardBackward('<?=$option_id;?>','<?=$option_sort_order;?>','backward')">                  <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />                </a>                <a href="javascript:;" onclick="MoveOptionForwardBackward('<?=$option_id;?>','<?=$option_sort_order;?>','forward')">                  <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />                </a>            <?php                 }              } // if($count_options > 1)            ?>          </td>          <td width="7.5%">            <a href="/_admin/catalog/products-options-details.php?option_id=<?=$option_id;?>">              <img src="/_admin/images/edit.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_edit'];?>" title="<?=$languages[$current_lang]['title_edit'];?>" width="16" height="16" />            </a>          </td>          <td width="7.5%">            <a href="javascript:;" class="delete_option_link" data-id="<?=$option_id;?>">              <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />            </a>          </td>        </tr>      </tbody>    </table><?php      $key++;    }    mysqli_free_result($result_options);?><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_option_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteOption('first');      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_option_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_option_link").click(function() {    $(".delete_option_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php  }  else {?>      <tr>        <td width="60%" class="text_left"><?=$languages[$current_lang]['text_no_options_yet'];?></td>        <td></td>      </tr><?php  }}function list_products_options_values() {    global $db_link;  global $languages;  global $current_lang;  global $current_option_id;  global $languages_array;  global $isset_submit_product_option;  global $option_values_array;  global $ovd_names_array;  global $product_option_errors;?>  <table class="border">    <thead>      <tr>        <th width="55%" class="text_left"><?=$languages[$current_lang]['header_option_value'];?></th>        <th width="5%"><?=$languages[$current_lang]['header_option_value_id'];?></th>        <th width="10%"><?=$languages[$current_lang]['header_reorder'];?></th>        <th width="20%"><?=$languages[$current_lang]['header_option_value_image'];?></th>        <th width="10%"><?=$languages[$current_lang]['header_actions'];?></th>      </tr>    </thead><?php  if(!$isset_submit_product_option) {    $query_option_values = "SELECT `option_value_id`,`ov_image_path`,`ov_sort_order`                             FROM `option_value`                            WHERE `option_id` = '$current_option_id'                            ORDER BY `ov_sort_order` ASC";    //echo $query_option_values;    $result_option_values = mysqli_query($db_link, $query_option_values);    if(!$result_option_values) echo mysqli_error($db_link);    $option_values_count = mysqli_num_rows($result_option_values);    if($option_values_count > 0) {      while($row_option_values = mysqli_fetch_assoc($result_option_values)) {        $option_values_array[] = $row_option_values;      }    }  }  else {    $option_values_count = count($option_values_array);  }  if(!empty($option_values_array)) {    foreach($option_values_array as $option_key => $option_value) {      $option_value_id = $option_value['option_value_id'];      $ov_image_path = $option_value['ov_image_path'];      $ov_sort_order = $option_value['ov_sort_order'];  ?>      <tbody id="option_value_row_<?=$option_key;?>">        <tr>          <td width="55%" class="text_left">           <?php      foreach($languages_array as $key => $row_languages) {        $language_id = $row_languages['language_id'];        $language_code = $row_languages['language_code'];        $language_menu_name = $row_languages['language_menu_name'];        if(!$isset_submit_product_option) {          $query_ovd_names = "SELECT `ovd_name`                              FROM `option_value_description`                              WHERE `option_value_id` = '$option_value_id' AND `language_id` = '$language_id'";          //echo $query_ovd_names;          $result_ovd_names = mysqli_query($db_link, $query_ovd_names);          if(!$result_ovd_names) echo mysqli_error($db_link);          $ovd_count = mysqli_num_rows($result_ovd_names);          if($ovd_count > 0) {            while($row = mysqli_fetch_assoc($result_ovd_names)) {              $ovd_names_array[$option_value_id][$language_id] = $row['ovd_name'];            }          }        }        $ovd_name = "";        $input_new_entry = "";        if(isset($ovd_names_array['new_entry'][$option_key])) {          $ovd_name = $ovd_names_array['new_entry'][$option_key][$language_id];          $input_new_entry = '<input type="hidden" name="option_value['.$option_key.'][new_entry]" value="1" />';        }        if(isset($ovd_names_array[$option_value_id][$language_id])) {          $ovd_name = $ovd_names_array[$option_value_id][$language_id];        }        ?>        <div>            <?=$input_new_entry;?>            <input type="hidden" name="option_value[<?=$option_key;?>][option_value_id]" value="<?=$option_value_id;?>" />            <input type="text" name="option_value[<?=$option_key;?>][ovd_name][<?=$language_id;?>]" style="width: 400px;" value="<?=$ovd_name;?>" />          &nbsp;&nbsp;<img src="/_admin/images/flags/<?=$language_code;?>.png" title="<?=$language_menu_name;?>" />          <?php            if(isset($product_option_errors[$option_key]['ovd_name'][$language_id])) {              echo "<div class='error'>".$product_option_errors[$option_key]['ovd_name'][$language_id]."</div>";            }          ?>          <p class="clearfix"></p>        </div>  <?php      } // foreach($languages_array)  ?>        </td>        <td width="5%"><?="$current_option_id.$option_value_id";?></td>        <td width="10%">          <div class="float_left" style="width:49%;">            <input type="text" name="option_value[<?=$option_key;?>][ov_sort_order]" value="<?=$ov_sort_order;?>" style="width: 20px;">&nbsp;          </div>          <div class="float_left" style="width:49%;">          <?php            // if($option_values_count > 1) we gonna give the appropriate moveing options            // else we gonna leave this empty            if($option_values_count > 1) {              if($option_key == 0) {            ?>              <a href="javascript:;" onclick="MoveOptionValueForwardBackward('<?=$current_option_id;?>','<?=$option_value_id;?>','<?=$ov_sort_order;?>','<?=$option_key;?>','backward')">                <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />              </a>            <?php } elseif($option_key == $option_values_count-1) { ?>              <a href="javascript:;" onclick="MoveOptionValueForwardBackward('<?=$current_option_id;?>','<?=$option_value_id;?>','<?=$ov_sort_order;?>','<?=$option_key;?>','forward')">                <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />              </a>            <?php } else { ?>              <a href="javascript:;" onclick="MoveOptionValueForwardBackward('<?=$current_option_id;?>','<?=$option_value_id;?>','<?=$ov_sort_order;?>','<?=$option_key;?>','backward')">                <img src="/_admin/images/arrow-d.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_backward'];?>" title="<?=$languages[$current_lang]['title_move_backward'];?>" width="16" height="16" />              </a>              <a href="javascript:;" onclick="MoveOptionValueForwardBackward('<?=$current_option_id;?>','<?=$option_value_id;?>','<?=$ov_sort_order;?>','<?=$option_key;?>','forward')">                <img src="/_admin/images/arrow-u.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_move_forward'];?>" title="<?=$languages[$current_lang]['title_move_forward'];?>" width="16" height="16" />              </a>          <?php               }            } // if($option_values_count > 1)          ?>          </div>        </td>        <td width="20%">          <div class="ov_image">            <!--<label for="ov_image" class="title"><?=$languages[$current_lang]['header_ov_image'];?></label>-->            <?php              $class_hidden_input = "";              if(isset($ov_image_path) && !empty($ov_image_path)) {                $class_hidden_input = "hidden";                $confirm_text = $languages[$current_lang]['delete_image_warning'];                echo "<div class='ov_image_div'><img src='$ov_image_path' ><a class='delete_image button red' onclick=\"if(confirm('$confirm_text')) DeleteOptionValueImage('$option_value_id','$option_key')\">".$languages[$current_lang]['btn_delete']."</a></div>";              }              if(isset($category_errors['ov_image_path'])) {                echo "<div class='error'>".$category_errors['ov_image_path']."</div>";              }            ?>            <input type="file" name="ov_image_file[<?=$option_key;?>]" class="ov_image_file <?=$class_hidden_input;?>" style="width: auto;" />            <input type="hidden" name="ov_image_path" class="ov_image_path" value="<?=$ov_image_path;?>" />          </div>        </td>        <td width="10%">          <a href="javascript:;" class="delete_option_value_link" data-id="<?=$option_value_id;?>" data-row="<?=$option_key;?>">            <img src="/_admin/images/delete.gif" class="systemicon" alt="<?=$languages[$current_lang]['alt_delete'];?>" title="<?=$languages[$current_lang]['title_delete'];?>" width="16" height="16" />          </a>        </td>      </tr>    </tbody>  <?php    } // foreach($option_values_array)  } // if(!empty($option_values_array))  else {    $option_values_count = 1;?>    <tbody id="option_value_row_0">      <tr>        <td width="55%" class="text_left">                 <?php          foreach($languages_array as $key => $row_languages) {            $language_id = $row_languages['language_id'];            $language_code = $row_languages['language_code'];            $language_menu_name = $row_languages['language_menu_name'];        ?>          <div>            <?php              if(isset($product_option_errors['option_ovd_name'][$language_id])) {                echo "<div class='error'>".$product_option_errors['option_ovd_name'][$language_id]."</div>";              }            ?>              <input type="hidden" name="option_value[0][new_entry]" value="1" />              <input type="hidden" name="option_value[0][option_value_id]" value="" />              <input type="text" name="option_value[0][ovd_name][<?=$language_id;?>]" style="width: 400px;" />            &nbsp;&nbsp;<img src="/_admin/images/flags/<?=$language_code;?>.png" title="<?=$language_menu_name;?>" />            <p class="clearfix"></p>          </div>        <?php          } // foreach($languages_array        ?>        </td>        <td width="5%"></td>        <td width="10%"><input type="text" name="option_value[0][ov_sort_order]" value="" style="width: 20px;"></td>        <td width="20%">          <div class="ov_image"><input type="file" name="ov_image_file[0]" class="ov_image_file" style="width: auto;" /></div>        </td>        <td width="10%"></td>      </tr>    </tbody><?php  }?>  <tfoot>    <tr>      <td width="60%" class="text_left">        <a class="button green" onClick="AddOptionValue()"><i class="icon icon_plus_sign"></i><?=$languages[$current_lang]['btn_add_new_row'];?></a>      </td>      <td width="20%"></td>      <td width="20%"></td>    </tr>  </tfoot></table><input type="hidden" id="option_values_count" value="<?=$option_values_count;?>" /><div id="delete_result" style="display:none;"></div><div style="display:none;" id="modal_confirm" class="clearfix" title="<?=$languages[$current_lang]['are_you_sure']?>">  <p style="padding:0;margin:0;width:100%;float:left;"><?=$languages[$current_lang]['delete_products_option_warning']?></p></div><script>$(function() {  $("#modal_confirm").dialog({    resizable: false,    width: 400,    height: 200,    autoOpen: false,    modal: true,    draggable: false,    closeOnEscape: true,    dialogClass: "modal_confirm",    buttons: {      "<?=$languages[$current_lang]['btn_delete'];?>": function() {        DeleteOptionValue('first');      },      "<?=$languages[$current_lang]['btn_cancel'];?>": function() {        $(".delete_option_value_link").removeClass("active");        $(this).dialog("close");      }    }  });  $(".delete_option_value_link").click(function() {    $(".delete_option_value_link").removeClass("active");    $(this).addClass("active");    $("#modal_confirm").dialog("open");  });});</script><?php}function list_date_months_in_select($select_name_id,$current_month = false) {  global $languages;  global $current_lang;?>    <select name="<?=$select_name_id;?>" id="<?=$select_name_id;?>" style="width: auto;"><?php    if(!$current_month) {      $date = new DateTime();      $current_month = $date->format('m');    }    for($month = 01; $month <= 12; $month += 01) {      $padded_month = sprintf('%02d', $month);      $option_name = "option_date_month_$padded_month";      $selected = ($current_month == $month) ? ' selected="selected"' : "";      echo "<option value='$padded_month'$selected>".$languages[$current_lang][$option_name]."</option>";    }?>    </select><?php}function list_date_days_in_select($select_name_id,$current_day = false) {?>    <select name="<?=$select_name_id;?>" id="<?=$select_name_id;?>" style="width: auto;"><?php    $date = new DateTime();    $last_day = $date->format('t');    if(!$current_day) $current_day = $date->format('d');    for($days = 01; $days <= $last_day; $days += 01) {      $padded_day = sprintf('%02d', $days);      $selected = ($current_day == $days) ? ' selected="selected"' : "";      echo "<option value='$padded_day'$selected>$padded_day</option>";    }?>    </select><?php}function list_date_years_in_select($select_name_id,$current_year = false) {?>    <select name="<?=$select_name_id;?>" id="<?=$select_name_id;?>" style="width: auto;"><?php    if(!$current_year) {      $date = new DateTime();      $current_year = $date->format('Y');    }    $start_year = $current_year-10;    $end_year = $current_year+15;    for($year = $start_year; $year <= $end_year; $year++) {      $selected = ($current_year == $year) ? ' selected="selected"' : "";      echo "<option value='$year'$selected>$year</option>";    }?>    </select><?php}function list_date_hours_in_select($select_name_id,$current_hour = false) {?>    <select name="<?=$select_name_id;?>" id="<?=$select_name_id;?>" style="width: auto;"><?php    if(!$current_hour) {      $date = new DateTime();      $current_hour = $date->format('H');    }    $last_hour = "24";    for($hours = 00; $hours <= $last_hour; $hours += 01) {      $padded_hour = sprintf('%02d', $hours);      $selected = ($current_hour == $hours) ? ' selected="selected"' : "";      echo "<option value='$padded_hour'$selected>$padded_hour</option>";    }?>    </select><?php}function list_date_minutes_in_select($select_name_id,$current_minute = false) {?>    <select name="<?=$select_name_id;?>" id="<?=$select_name_id;?>" style="width: auto;"><?php    if(!$current_minute) {      $date = new DateTime();      $current_minute = $date->format('i');    }    $last_minute = "59";    for($minutes = 00; $minutes <= $last_minute; $minutes += 01) {      $padded_minute = sprintf('%02d', $minutes);      $selected = ($current_minute == $minutes) ? ' selected="selected"' : "";      echo "<option value='$padded_minute'$selected>$padded_minute</option>";    }?>    </select><?php}function list_date_seconds_in_select($select_name_id,$current_second = false) {?>    <select name="<?=$select_name_id;?>" id="<?=$select_name_id;?>" style="width: auto;"><?php    if(!$current_second) {      $date = new DateTime();      $current_second = $date->format('s');    }    $last_second = "59";    for($seconds = 00; $seconds <= $last_second; $seconds += 01) {      $padded_second = sprintf('%02d', $seconds);      $selected = ($current_second == $seconds) ? ' selected="selected"' : "";      echo "<option value='$padded_second'$selected>$padded_second</option>";    }?>    </select><?php}